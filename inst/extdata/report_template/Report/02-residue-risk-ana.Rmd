# 蔬菜产品中农药（兽药）残留风险分析

&emsp;&emsp;

## 总体残留风险

```{r full-sample}
full_sample <- spec_dataset(dims_comb_data, dims, ana_threshold, "product")
```

&emsp;&emsp;`r year_range[1]`-`r year_range[2]` 年共抽取样本 `r nrow(treated_data)` 例，总体合格率为 `r full_sample[["qualification_rate_percent"]]`%。

## 各年份残留风险

```{r year}
year <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", year) %>%
  factor_dims(year)
```

`r text_threshold(data = year, threshold_data = ana_threshold, dims = dims, ana_dims = c("year"))`

(ref:year) 各年份样本量与合格率

```{r year-table, results="asis", dev='png'}
sp_dable(
  year, ref_text = "(ref:year)",
  order = list(list("qualification_rate_percent", "desc"))
)
```

&emsp;&emsp;表 \@ref(tab:year) 给出了 `r year_range[1]` - `r year_range[2]` 年蔬菜类产品年抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-bar-line-eplot)。可以看出，`r year_range[1]` - `r year_range[2]` 年蔬菜类产品年抽检样本量在 `r text_range(year, "sample_size")` 之间，合格率稳定在 `r text_range(year, "qualification_rate_percent")` 之间。

```{r year-bar-line-eplot, fig.cap="各年份合格率折线图与样本量柱状图"}
bar_line_eplot(year, x_var = "year")
```

## 各季度残留风险

```{r quarter}
quarter <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", quarter) %>%
  factor_dims(quarter)
```

`r text_threshold(data = quarter, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter"))`

(ref:quarter) 各季度样本量与合格率

```{r quarter-table, results="asis", dev='png'}
sp_dable(
  quarter, ref_text = "(ref:quarter)",
  order = list(list("qualification_rate_percent", "desc"))
)
```

&emsp;&emsp;表 \@ref(tab:quarter) 给出了 `r year_range[2] - year_range[1] + 1` 年内四个季度蔬菜类产品的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-bar-line-eplot)。可以看出，四个季度的蔬菜类产品抽检样本量在 `r text_range(quarter, "sample_size")` 之间，合格率稳定在 `r text_range(quarter, "qualification_rate_percent")` 之间。

```{r quarter-bar-line-eplot, fig.cap="各季度合格率折线图与样本量柱状图"}
bar_line_eplot(quarter, x_var = "quarter")
```

## 各省份残留风险

```{r province}
province <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", province)
```

`r text_threshold(data = province, threshold_data = ana_threshold, dims = dims, ana_dims = c("province"))`

(ref:province) 各省份样本量与合格率

```{r province-table, results="asis", dev='png'}
sp_dable(
  province, ref_text = "(ref:province)",
  order = list(list("qualification_rate_percent", "desc"))
)
```

&emsp;&emsp;表 \@ref(tab:province) 给出了全国 `r nrow(province)` 个省市自治区蔬菜类产品的抽检样本量及其合格率，各省蔬菜中农药残留超标率的展示见图 \@ref(fig:province-emap)。可以看出，`r nrow(province)` 个省市自治区的蔬菜类产品抽检样本量在 `r text_range(province, "sample_size")` 之间，合格率稳定在 `r text_range(province, "qualification_rate_percent")` 之间。

```{r province-emap, fig.cap="各省份超标率地图"}
emap(
  province %>% change_to_defective() %>% shorten_province_name(), 
  map_json = cn_province_map_json
)
```

## 各蔬菜类别残留风险

```{r category}
category <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", category) %>%
  factor_dims(category)
```

`r text_threshold(data = category, threshold_data = ana_threshold, dims = dims, ana_dims = c("category"))`

(ref:category) 各蔬菜类别样本量与合格率

```{r category-table, results="asis", dev='png'}
sp_dable(
  category, ref_text = "(ref:category)",
  order = list(list("qualification_rate_percent", "desc"))
)
```

&emsp;&emsp;表 \@ref(tab:category) 给出了 `r nrow(category)` 个蔬菜类别的抽检样本量及其合格率，其图形展示见图 \@ref(fig:category-bar-line-eplot) - 图 \@ref(fig:category-scatter-eplot)。可以看出，`r nrow(category)` 个蔬菜类别的抽检样本量在 `r text_range(category, "sample_size")` 之间，合格率稳定在 `r text_range(category, "qualification_rate_percent")` 之间。

```{r category-bar-line-eplot, fig.cap="各蔬菜类别合格率折线图与样本量柱状图"}
bar_line_eplot(category, x_var = "category", long_x_label = TRUE, x_name_gap = 40, x_label_width = 50)
```

```{r category-rose-eplot, fig.cap="各蔬菜类别样本量与合格率玫瑰图"}
category |> 
  e_charts(category) |> 
  e_pie(sample_size, roseType = "radius", center = c("25%", "50%"), radius = "45%") |> 
  e_pie(
    qualification_rate_percent, roseType = "radius", center = c("75%", "50%"), radius = "45%"
  ) |> 
  e_tooltip(trigger = "item")
```

```{r category-bar-eplot, fig.cap="各蔬菜类别合格率与样本量分组柱状图"}
bar_group_eplot(
  category, x_var = "category", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = TRUE, show_labels = TRUE
)
```

```{r category-scatter-eplot, fig.cap="各蔬菜类别样本量与合格率散点图"}
scatter_eplot(
  category, 
  x_var = "sample_size", y_var = "qualification_rate_percent", label_var = "category"
)
```

## 各品种残留风险

```{r product}
product <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", product) %>%
  factor_dims(product)
```

`r text_threshold(data = product, threshold_data = ana_threshold, dims = dims, ana_dims = c("product"))`

(ref:product) 各品种样本量与合格率

```{r product-table, results="asis", dev='png'}
sp_dable(
  product, ref_text = "(ref:product)",
  order = list(list("qualification_rate_percent", "desc"))
)
```

&emsp;&emsp;表 \@ref(tab:product) 给出了 `r nrow(product)` 个蔬菜品种的抽检样本量及其合格率，其图形展示见图 \@ref(fig:product-rose-eplot) - 图 \@ref(fig:product-scatter-eplot)。可以看出，`r nrow(product)` 个蔬菜品种的抽检样本量在 `r text_range(product, "sample_size")` 之间，合格率稳定在 `r text_range(product, "qualification_rate_percent")` 之间。

```{r product-rose-eplot, fig.cap="各品种样本量与合格率玫瑰图"}
product |> 
  e_charts(product) |> 
  e_pie(sample_size, roseType = "radius", center = c("25%", "50%"), radius = "45%") |>
  e_pie(
    qualification_rate_percent, roseType = "radius", center = c("75%", "50%"), radius = "45%"
  ) |> 
  e_tooltip(trigger = "item")
```

```{r product-bar-eplot, fig.cap="各品种合格率与样本量分组柱状图"}
bar_group_eplot(
  product, x_var = "product", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = T
)
```

```{r product-scatter-eplot, fig.cap="各品种样本量与合格率散点图"}
scatter_eplot(
  product, 
  x_var = "sample_size", y_var = "qualification_rate_percent", label_var = "product"
)
```

## “年份-季度”残留风险

```{r year-quarter}
year_quarter <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", year, quarter)
```

`r text_threshold(data = year_quarter, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter"))`

(ref:year-quarter) 各年份各季度样本量与合格率

```{r year-quarter-table, results="asis", dev='png'}
sp_dable(year_quarter %>% factor_dims(year, quarter), ref_text = "(ref:year-quarter)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter) 给出了 `r year_range[1]` - `r year_range[2]` 年每年四个季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-quarter-bar-line-eplot)。可以看出，`r year_range[2] - year_range[1] + 1` 年共 `r 4 * (year_range[2] - year_range[1] + 1 )` 个季度的抽检样本量在 `r text_range(year_quarter, "sample_size")` 之间，合格率稳定在 `r text_range(year_quarter, "qualification_rate_percent")` 之间。

```{r year-quarter-bar-line-eplot, fig.cap="各年份各季度样本量与合格率柱状图与折线图"}
bar_line_eplot(
  year_quarter %>% combine_year_quarter() %>% factor_dims(timeline), 
  x_var = "timeline",
  x_axis_name = "时间", x_name_gap = 40,
  long_x_label = TRUE, x_label_width = 30
) |> e_labels(fontWeight = "bold", fontSize = 11)
```

## “年份-省份”残留风险

```{r year-province}
year_province <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", year, province)
```

`r text_threshold(data = year_province, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province"))`

(ref:year-province) 各年份各省份样本量与合格率

```{r year-province-table, results="asis", dev='png'}
sp_dable(year_province %>% factor_dims(year, province), ref_text = "(ref:year-province)")
```

&emsp;&emsp;表 \@ref(tab:year-province) 给出了全国 `r nrow(province)` 个省市自治区在 `r year_range[1]` - `r year_range[2]` 年的抽检样本量及其合格率，各省各年蔬菜中农药残留超标率的展示见图 \@ref(fig:year-province-emap)。可以看出，`r nrow(province)` 个省市自治区每年的抽检样本量在 `r text_range(year_province, "sample_size")` 之间，合格率在 `r text_range(year_province, "qualification_rate_percent")` 之间。

```{r year-province-emap, fig.cap="各年份各省份超标率地图"}
emap(
  year_province %>% change_to_defective() %>% shorten_province_name(), 
  map_json = cn_province_map_json,
  timeline_var = "year"
)
```

## “年份-蔬菜类别”残留风险

```{r year-category}
year_category <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", year, category) %>%
  factor_dims(year, category)
```

`r text_threshold(data = year_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "category"))`

(ref:year-category) 各年份各蔬菜类别样本量与合格率

```{r year-category-table, results="asis", dev='png'}
sp_dable(year_category, ref_text = "(ref:year-category)")
```

&emsp;&emsp;表 \@ref(tab:year-category) 给出了 `r nrow(category)` 个蔬菜类别在 `r year_range[1]` - `r year_range[2]` 年的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-category-bar-line-eplot) - 图 \@ref(fig:year-category-bar-eplot)。可以看出，`r nrow(category)` 个蔬菜类别每年的抽检样本量在 `r text_range(year_category, "sample_size")` 之间，合格率在 `r text_range(year_category, "qualification_rate_percent")` 之间。

```{r year-category-bar-line-eplot, fig.cap="各年份各蔬菜类别合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(year_category, timeline_var = "year", x_var = "category")
```

```{r year-category-scatter-eplot, fig.cap="各年份各蔬菜类别合格率与样本量散点图"}
scatter_eplot_timeline(
  year_category, timeline_var = "year", 
  x_var = "category", y_var = "qualification_rate_percent", size_var = "sample_size",
  symbol_size = c(1,50)
)
```

```{r category-year-bar-line-eplot, fig.cap="各蔬菜类别各年份合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(
  year_category, timeline_var = "category", x_var = "year",
) |>
  e_timeline_opts(
    label = list(interval = 0, width = 50, overflow = "break"),
    padding = 0
  )
```

```{r year-category-bar-eplot, fig.cap="各年份各蔬菜类别合格率与样本量分组柱状图"}
bar_group_eplot(
  year_category, timeline_var = "year", 
  x_var = "category", bar_var = c("qualification_rate_percent", "sample_size"), 
  sec_y_axis = TRUE, show_labels = TRUE
)
```

## “年份-品种”残留风险

```{r year-product}
year_product <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", year, product) %>%
  factor_dims(year, product)
```

`r text_threshold(data = year_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "product"))`

(ref:year-product) 各年份各品种样本量与合格率

```{r year-product-table, results="asis", dev='png'}
sp_dable(year_product, ref_text = "(ref:year-product)")
```

&emsp;&emsp;表 \@ref(tab:year-product) 给出了 `r nrow(product)` 个蔬菜品种在 `r year_range[1]` - `r year_range[2]` 年的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-product-scatter-eplot) - 图 \@ref(fig:year-product-bar-eplot)。可以看出，`r nrow(product)` 个蔬菜品种每年的抽检样本量在 `r text_range(year_product, "sample_size")` 之间，合格率在 `r text_range(year_product, "qualification_rate_percent")` 之间。

```{r year-product-scatter-eplot, fig.cap="各年份各品种样本量与合格率散点图"}
scatter_eplot_timeline(
  year_product, timeline_var = "year", 
  x_var = "product", y_var = "qualification_rate_percent", size_var = "sample_size",
  x_label_width = 1
)
```

```{r year-product-bar-eplot, fig.cap="各年份各品种合格率与样本量分组柱状图"}
bar_group_eplot(
  year_product, timeline_var = "year", 
  x_var = "product", bar_var = c("qualification_rate_percent", "sample_size"), 
  sec_y_axis = T
)
```

## “季度-省份”残留风险

```{r quarter-province}
quarter_province <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", quarter, province) %>%
  factor_dims(quarter, province)
```

`r text_threshold(data = quarter_province, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province"))`

(ref:quarter-province) 各季度各省份样本量与合格率

```{r quarter-province-table, results="asis", dev='png'}
sp_dable(quarter_province, ref_text = "(ref:quarter-province)")
```

&emsp;&emsp;表 \@ref(tab:quarter-province) 给出了 `r nrow(province)` 个省市自治区在四个季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-province-emap)。可以看出，`r nrow(province)` 个省市自治区每个季度的抽检样本量在 `r text_range(quarter_province, "sample_size")` 之间，合格率在 `r text_range(quarter_province, "qualification_rate_percent")` 之间。

```{r quarter-province-emap, fig.cap="各季度各省份超标率地图"}
emap(
  quarter_province %>% change_to_defective() %>% shorten_province_name(), 
  map_json = cn_province_map_json,
  timeline_var = "quarter"
)
```

## “季度-蔬菜类别”残留风险

```{r quarter-category}
quarter_category <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", quarter, category) %>%
  factor_dims(quarter, category)
```

`r text_threshold(data = quarter_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "category"))`

(ref:quarter-category) 各季度各蔬菜类别样本量与合格率

```{r quarter-category-table, results="asis", dev='png'}
sp_dable(quarter_category, ref_text = "(ref:quarter-category)")
```

&emsp;&emsp;表 \@ref(tab:quarter-category) 给出了 `r nrow(category)` 个蔬菜类别在四个季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-category-bar-line-eplot) - 图 \@ref(fig:quarter-category-bar-eplot)。可以看出，`r nrow(category)` 个蔬菜类别每个季度的抽检样本量在 `r text_range(quarter_category, "sample_size")` 之间，合格率在 `r text_range(quarter_category, "qualification_rate_percent")` 之间。

```{r quarter-category-bar-line-eplot, fig.cap="各季度各蔬菜类别合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(quarter_category, timeline_var = "quarter", x_var = "category")
```

```{r quarter-category-scatter-eplot, fig.cap="各季度各蔬菜类别样本量与合格率散点图"}
scatter_eplot_timeline(
  quarter_category, timeline_var = "quarter",
  x_var = "category", y_var = "qualification_rate_percent", size_var = "sample_size",
  symbol_size = c(1, 50)
)
```

```{r category-quarter-bar-line-eplot, fig.cap="各蔬菜类别各季度合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(
  quarter_category, timeline_var = "category",
  x_var = "quarter"
) |>
  e_timeline_opts(
    label = list(interval = 0, width = 50, overflow = "break"),
    padding = 0
  )
```

```{r quarter-category-bar-eplot, fig.cap="各季度各蔬菜类别合格率样本量分组柱状图"}
bar_group_eplot(
  quarter_category, timeline_var = "quarter",
  x_var = "category", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = TRUE, show_labels = TRUE
)
```

## “季度-品种”残留风险

```{r quarter-product}
quarter_product <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", quarter, product) %>%
  factor_dims(quarter, product)
```

`r text_threshold(data = quarter_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "product"))`

(ref:quarter-product) 各季度各品种样本量与合格率

```{r quarter-product-table, results="asis", dev='png'}
sp_dable(quarter_product, ref_text = "(ref:quarter-product)")
```

&emsp;&emsp;表 \@ref(tab:quarter-product) 给出了 `r nrow(product)` 个蔬菜品种在四个季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-product-scatter-eplot) - 图 \@ref(fig:quarter-product-bar-eplot)。可以看出，`r nrow(product)` 个蔬菜品种每个季度的抽检样本量在 `r text_range(quarter_product, "sample_size")` 之间，合格率在 `r text_range(quarter_product, "qualification_rate_percent")` 之间。

```{r quarter-product-scatter-eplot, fig.cap="各季度各品种合格率与样本量散点图"}
scatter_eplot_timeline(
  quarter_product, timeline_var = "quarter", 
  x_var = "product", y_var = "qualification_rate_percent", size_var = "sample_size",
  x_label_width = 1
)
```

```{r quarter-product-bar-eplot, fig.cap="各季度各品种合格率与样本量分组柱状图"}
bar_group_eplot(
  quarter_product, timeline_var = "quarter",
  x_var = "product", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = TRUE
)
```

## “省份-蔬菜类别”残留风险

```{r province-category}
province_category <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", province, category) %>%
  factor_dims(province, category)
```

`r text_threshold(data = province_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("province", "category"))`

(ref:province-category) 各省份各蔬菜类别样本量与合格率

```{r province-category-table, results="asis", dev='png'}
sp_dable(province_category, ref_text = "(ref:province-category)")
```

&emsp;&emsp;表 \@ref(tab:province-category) 给出了 `r nrow(province)` 个省市自治区分别在 `r nrow(category)` 个蔬菜类别上的抽检样本量及其合格率，各省份各蔬菜类别的农药残留超标率展示见图 \@ref(fig:province-category-emap)。可以看出，各省份各蔬菜类别的抽检样本量在 `r text_range(province_category, "sample_size")` 之间，合格率在 `r text_range(province_category, "qualification_rate_percent")` 之间。

```{r province-category-emap, fig.cap="各省份各蔬菜类别超标率地图"}
emap(
  province_category %>% change_to_defective() %>% shorten_province_name(), 
  map_json = cn_province_map_json,
  timeline_var = "category"
) |> e_timeline_opts(controlStyle = list(showPlayBtn = FALSE))
```

## “省份-品种”残留风险

```{r province-product}
province_product <- spec_dataset(dims_comb_data, dims, ana_threshold, "product", province, product) %>%
  factor_dims(province, product)
```

`r text_threshold(data = province_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("province", "product"))`

(ref:province-product) 各省份各品种样本量与合格率

```{r province-product-table, results="asis", dev='png'}
sp_dable(province_product, ref_text = "(ref:province-product)")
```

&emsp;&emsp;表 \@ref(tab:province-product) 给出了 `r nrow(province)` 个省市自治区分别在 `r nrow(product)` 个蔬菜类别上的抽检样本量及其合格率，各省份各蔬菜类别的农药残留超标率展示见图 \@ref(fig:province-product-eheatmap)。可以看出，各省份各蔬菜类别的抽检样本量在 `r text_range(province_product, "sample_size")` 之间，合格率在 `r text_range(province_product, "qualification_rate_percent")` 之间。

```{r province-product-eheatmap, fig.cap="各省份各蔬菜类别超标率热力图"}
heatmap(
  province_product |> change_to_defective() |> shorten_province_name(), 
  x_var = "product", y_var = "province", value_var = "defective_rate_percent"
)
```

## “年份-季度-省份”残留风险

```{r year-quarter-province}
year_quarter_province <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, quarter, province
)
```

`r text_threshold(data = year_quarter_province, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "province"))`

(ref:year-quarter-province) 各年份各季度各省份样本量与合格率

```{r year-quarter-province-table, results="asis", dev='png'}
sp_dable(
  year_quarter_province %>%
    factor_dims(year, quarter, province), 
  ref_text = "(ref:year-quarter-province)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-province) 给出了 `r nrow(province)` 个省市自治区在 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度的抽检样本量及其合格率，各年份各季度各省份的农药残留超标率展示见图 \@ref(fig:province-product-eheatmap) 和图 \@ref(fig:year-quarter-province-eheatmap)。可以看出，各年份各季度各省份的抽检样本量在 `r text_range(year_quarter_province, "sample_size")` 之间，合格率在 `r text_range(year_quarter_province, "qualification_rate_percent")` 之间。

```{r year-quarter-province-emap, fig.cap="各年份各季度各省份超标率地图"}
emap(
  year_quarter_province %>% 
    combine_year_quarter %>%
    change_to_defective() %>%
    shorten_province_name() %>% 
    factor_dims(timeline), 
  map_json = cn_province_map_json,
  timeline_var = "timeline", 
  interval = 3, timeline_label_width = 60
)
```

```{r year-quarter-province-eheatmap, fig.cap="各年份各季度各省份超标率热力图"}
heatmap(
  year_quarter_province %>% 
    combine_year_quarter %>%
    change_to_defective() %>%
    shorten_province_name() %>%
    factor_dims(timeline),
  x_var = "province", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度"
)
```


## “年份-季度-蔬菜类别”残留风险

```{r year-quarter-category}
year_quarter_category <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, quarter, category
)
```

`r text_threshold(data = year_quarter_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "category"))`

(ref:year-quarter-category) 各年份各季度各蔬菜类别样本量与合格率

```{r year-quarter-category-table, results="asis", dev='png'}
sp_dable(
  year_quarter_category %>% factor_dims(year, quarter, category), 
  ref_text = "(ref:year-quarter-category)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-category) 给出了 `r nrow(category)` 个蔬菜类别在 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-quarter-category-bar-line-eplot) - 图 \@ref(fig:year-quarter-category-bar-eplot)。可以看出，各年份各季度各蔬菜类别的抽检样本量在 `r text_range(year_quarter_category, "sample_size")` 之间，合格率在 `r text_range(year_quarter_category, "qualification_rate_percent")` 之间。

```{r year-quarter-category-bar-line-eplot, fig.cap="各年份各季度各蔬菜类别合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(
  year_quarter_category %>% combine_year_quarter() %>% factor_dims(timeline, category), 
  timeline_var = "timeline", x_var = "category"
)
```

```{r year-quarter-category-scatter-eplot, fig.cap="各年份各季度各蔬菜类别合格率与样本量散点图"}
scatter_eplot_timeline(
  year_quarter_category %>% combine_year_quarter() %>% factor_dims(timeline, category), 
  timeline_var = "timeline", 
  x_var = "category", y_var = "qualification_rate_percent", size_var = "sample_size",
  symbol_size = c(1,50), interval = 3, timeline_label_width = 60
)
```

```{r category-year-quarter-bar-line-eplot, fig.cap="各蔬菜类别各年份各季度合格率折线图与样本量柱状图"}
bar_line_eplot_timeline(
  year_quarter_category %>% combine_year_quarter() %>% factor_dims(timeline, category), 
  timeline_var = "category",
  x_var = "timeline", show_label = FALSE,
  long_x_label = TRUE, x_label_width = 30
) |>
  e_timeline_opts(
    label = list(interval = 0, width = 60, overflow = "break"),
    padding = 0
  )
```

```{r year-quarter-category-eheatmap, fig.cap="各年份各季度各蔬菜类别超标率热力图"}
heatmap(
  year_quarter_category %>% 
    combine_year_quarter() %>% 
    change_to_defective() %>% 
    factor_dims(timeline, category), 
  x_var = "category", y_var = "timeline", value_var = "defective_rate_percent",
  width = "100%", height = "600%",
  y_axis_name = "年份-季度", x_label_width = 50
)
```

```{r year-quarter-category-bar-eplot, fig.cap="各年份各季度各蔬菜类别合格率与样本量分组柱状图"}
bar_group_eplot(
  year_quarter_category %>% combine_year_quarter() %>% factor_dims(timeline, category), 
  timeline_var = "timeline", 
  x_var = "category", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = TRUE, show_labels = TRUE
)
```

## “年份-季度-品种”残留风险

```{r year-quarter-product}
year_quarter_product <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, quarter, product
)
```

`r text_threshold(data = year_quarter_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "product"))`

(ref:year-quarter-product) 各年份各季度各品种样本量与合格率

```{r year-quarter-product-table, results="asis", dev='png'}
sp_dable(
  year_quarter_product %>%
    factor_dims(year, quarter, product), 
  ref_text = "(ref:year-quarter-product)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-product) 给出了 `r nrow(product)` 个蔬菜品种在 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-quarter-product-eheatmap) 和图 \@ref(fig:year-quarter-product-bar-eplot)。可以看出，各年份各季度各蔬菜品种的抽检样本量在 `r text_range(year_quarter_product, "sample_size")` 之间，合格率在 `r text_range(year_quarter_product, "qualification_rate_percent")` 之间。

```{r year-quarter-product-eheatmap, fig.cap="各年份各季度各品种超标率热力图"}
heatmap(
  year_quarter_product %>% 
    combine_year_quarter() %>%
    change_to_defective() %>%
    factor_dims(timeline, product),
  x_var = "product", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度"
)
```

```{r year-quarter-product-bar-eplot, fig.cap="各年份各季度各品种合格率与样本量分组柱状图"}
bar_group_eplot(
  year_quarter_product %>% combine_year_quarter() %>% factor_dims(timeline, product), 
  timeline_var = "timeline", 
  x_var = "product", bar_var = c("qualification_rate_percent", "sample_size"),
  sec_y_axis = TRUE
)
```

## “年份-省份-蔬菜类别”残留风险

> 带时间轴的热力图无法展示部分数据。这部分数据在热力图的时间轴、X轴和Y轴均有较大程度的缺失，因此无法被选中进行可视化。

```{r year-province-category}
year_province_category <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, province, category
)
```

`r text_threshold(data = year_province_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province", "category"))`

(ref:year-province-category) 各年份各省份各蔬菜类别样本量与合格率

```{r year-province-category-table, results="asis", dev='png'}
sp_dable(
  year_province_category %>% factor_dims(year, province, category), 
  ref_text = "(ref:year-province-category)"
)
```

&emsp;&emsp;表 \@ref(tab:year-province-category) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(province)` 个省市自治区的 `r nrow(category)` 个蔬菜类别的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-province-category-eheatmap) 和图 \@ref(fig:year-province-category-2020-eheatmap)。可以看出，各年份各省份各蔬菜类别的抽检样本量在 `r text_range(year_province_category, "sample_size")` 之间，合格率在 `r text_range(year_province_category, "qualification_rate_percent")` 之间。

```{r year-province-category-eheatmap, fig.cap="各年份各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name(),
  timeline_var = "year",
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

```{r year-province-category-2016-eheatmap, fig.cap="2016年各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2016),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

```{r year-province-category-2017-eheatmap, fig.cap="2017年各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2017),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

```{r year-province-category-2018-eheatmap, fig.cap="2018年各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2018),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

```{r year-province-category-2019-eheatmap, fig.cap="2019年各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2019),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

```{r year-province-category-2020-eheatmap, fig.cap="2020年各省份各蔬菜类别超标率热力图"}
heatmap(
  year_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2020),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60, width = "100%", height = "400%"
)
```

## “年份-省份-品种”残留风险

> 带时间轴的热力图无法展示部分数据。这部分数据在热力图的时间轴、X轴和Y轴均有较大程度的缺失，因此无法被选中进行可视化。

```{r year-province-product}
year_province_product <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, province, product
) %>%
  factor_dims(year, province, product)
```

`r text_threshold(data = year_province_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province", "product"))`

(ref:year-province-product) 各年份各省份各品种样本量与合格率

```{r year-province-product-table, results="asis", dev='png'}
sp_dable(year_province_product, ref_text = "(ref:year-province-product)")
```

&emsp;&emsp;表 \@ref(tab:year-province-product) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(province)` 个省市自治区的 `r nrow(product)` 个蔬菜品种的抽检样本量及其合格率，其图形展示见图 \@ref(fig:year-province-product-eheatmap) 和图 \@ref(fig:year-province-product-2020-eheatmap)。可以看出，各年份各省份各蔬菜品种的抽检样本量在 `r text_range(year_province_product, "sample_size")` 之间，合格率在 `r text_range(year_province_product, "qualification_rate_percent")` 之间。

```{r year-province-product-eheatmap, fig.cap="各年份各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name(),
  timeline_var = "year",
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r year-province-product-2016-eheatmap, fig.cap="2016年各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2016),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r year-province-product-2017-eheatmap, fig.cap="2017年各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2017),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r year-province-product-2018-eheatmap, fig.cap="2018年各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2018),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r year-province-product-2019-eheatmap, fig.cap="2019年各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2019),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r year-province-product-2020-eheatmap, fig.cap="2020年各省份各品种超标率热力图"}
heatmap(
  year_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(year == 2020),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

## “季度-省份-蔬菜类别”残留风险


> 带时间轴的热力图无法展示部分数据。这部分数据在热力图的时间轴、X轴和Y轴均有较大程度的缺失，因此无法被选中进行可视化。

```{r quarter-province-category}
quarter_province_category <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  quarter, province, category
) %>%
  factor_dims(quarter, province, category)
```

`r text_threshold(data = quarter_province_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province", "category"))`

(ref:quarter-province-category) 各季度各省份各蔬菜类别样本量与合格率

```{r quarter-province-category-table, results="asis", dev='png'}
sp_dable(quarter_province_category, ref_text = "(ref:quarter-province-category)")
```

&emsp;&emsp;表 \@ref(tab:quarter-province-category) 给出了第一季度到第四季度 `r nrow(province)` 个省市自治区的 `r nrow(category)` 个蔬菜类别的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-province-category-eheatmap) 和图 \@ref(fig:quarter-province-category-Q4-eheatmap)。可以看出，各季度各省份各蔬菜类别的抽检样本量在 `r text_range(quarter_province_category, "sample_size")` 之间，合格率在 `r text_range(quarter_province_category, "qualification_rate_percent")` 之间。

```{r quarter-province-category-eheatmap, fig.cap="各季度各省份各蔬菜类别超标率热力图"}
heatmap(
  quarter_province_category %>% change_to_defective() %>% shorten_province_name(),
  timeline_var = "quarter",
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "400%"
)
```

```{r quarter-province-category-Q1-eheatmap, fig.cap="第一季度各省份各蔬菜类别超标率热力图"}
heatmap(
  quarter_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第一季度"),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "550%"
)
```

```{r quarter-province-category-Q2-eheatmap, fig.cap="第二季度各省份各蔬菜类别超标率热力图"}
heatmap(
  quarter_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第二季度"),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "550%"
)
```

```{r quarter-province-category-Q3-eheatmap, fig.cap="第三季度各省份各蔬菜类别超标率热力图"}
heatmap(
  quarter_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第三季度"),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "550%"
)
```

```{r quarter-province-category-Q4-eheatmap, fig.cap="第四季度各省份各蔬菜类别超标率热力图"}
heatmap(
  quarter_province_category %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第四季度"),
  x_var = "category", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "550%"
)
```

## “季度-省份-品种”残留风险

```{r quarter-province-product}
quarter_province_product <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  quarter, province, product
) %>%
  factor_dims(quarter, province, product)
```

`r text_threshold(data = quarter_province_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province", "product"))`

(ref:quarter-province-product) 各季度各省份各品种样本量与合格率

```{r quarter-province-product-table, results="asis", dev='png'}
sp_dable(quarter_province_product, ref_text = "(ref:quarter-province-product)")
```

&emsp;&emsp;表 \@ref(tab:quarter-province-product) 给出了第一季度到第四季度 `r nrow(province)` 个省市自治区的 `r nrow(product)` 个蔬菜品种的抽检样本量及其合格率，其图形展示见图 \@ref(fig:quarter-province-product-eheatmap) 和图 \@ref(fig:quarter-province-product-Q4-eheatmap)。可以看出，各季度各省份各蔬菜品种的抽检样本量在 `r text_range(quarter_province_product, "sample_size")` 之间，合格率在 `r text_range(quarter_province_product, "qualification_rate_percent")` 之间。

```{r quarter-province-product-eheatmap, fig.cap="各季度各省份各品种超标率热力图"}
heatmap(
  quarter_province_product %>% change_to_defective() %>% shorten_province_name(),
  timeline_var = "quarter",
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "200%"
)
```

```{r quarter-province-product-Q1-eheatmap, fig.cap="第一季度各省份各品种超标率热力图"}
heatmap(
  quarter_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第一季度"),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "300%"
)
```

```{r quarter-province-product-Q2-eheatmap, fig.cap="第二季度各省份各品种超标率热力图"}
heatmap(
  quarter_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第二季度"),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "300%"
)
```

```{r quarter-province-product-Q3-eheatmap, fig.cap="第三季度各省份各品种超标率热力图"}
heatmap(
  quarter_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第三季度"),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "300%"
)
```

```{r quarter-province-product-Q4-eheatmap, fig.cap="第四季度各省份各品种超标率热力图"}
heatmap(
  quarter_province_product %>% change_to_defective() %>% shorten_province_name() %>% filter(quarter == "第四季度"),
  x_var = "product", y_var = "province", value_var = "defective_rate_percent",
  x_label_width = 60,
  width = "100%", height = "300%"
)
```

## “年份-季度-省份-产品类别”残留风险

```{r year-quarter-province-category, cache=!params$product_env}
year_quarter_province_category <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, quarter, province, category
)
```

`r text_threshold(data = year_quarter_province_category, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "province", "category"))`

(ref:year-quarter-province-category) 各年份各季度各省份各蔬菜类别样本量与合格率

```{r year-quarter-province-category-table, results="asis", dev='png'}
sp_dable(
  year_quarter_province_category %>%
    factor_dims(year, quarter, province, category), 
  ref_text = "(ref:year-quarter-province-category)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-province-category) 给出了 `r year_range[1]` - `r year_range[2]` 年第一季度到第四季度 `r nrow(province)` 个省市自治区的 `r nrow(category)` 个蔬菜品种的抽检样本量及其合格率。可以看出，各季度各省份各蔬菜品种的抽检样本量在 `r text_range(year_quarter_province_category, "sample_size")` 之间，合格率在 `r text_range(year_quarter_province_category, "qualification_rate_percent")` 之间。

`r if (FALSE) '
## “年份-季度-省份-品种”残留风险（不分析）
'`
```{r year-quarter-province-product, eval=FALSE}
year_quarter_province_product <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product", 
  year, quarter, province, product
) %>%
  factor_dims(year, quarter, province, product)
```

`r if (FALSE) text_threshold(data = year_quarter_province_product, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "province", "product"))`

(ref:year-quarter-province-product) 各年份各季度各省份各品种样本量与合格率

```{r year-quarter-province-product-table, results="asis", dev='png', eval=FALSE}
sp_dable(year_quarter_province_product, ref_text = "(ref:year-quarter-province-product)")
```

## 各农药残留风险

```{r drug}
drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", drug) %>%
  factor_dims(drug)
```

`r text_threshold(data = drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("drug"))`

(ref:drug) 各农药总体检出率与合格率

```{r drug-table, results="asis", dev='png'}
sp_dable(drug, ref_text = "(ref:drug)")
```

&emsp;&emsp;表 \@ref(tab:drug) 给出了 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:drug-scatter-eplot)。可以看出，`r nrow(drug)` 种农药抽检样本量在 `r text_range(drug, "sample_size")` 之间，检出率稳定在 `r text_range(drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(drug, "qualification_rate_percent")` 之间。

```{r drug-scatter-eplot, fig.cap="各农药检出率与超标率散点图"}
scatter_eplot(
  drug %>% change_to_defective(), 
  x_var = "detection_rate_percent", y_var = "defective_rate_percent", label_var = "drug",
  increment = 1
)
```

## “年份-药品”残留风险

```{r year-drug}
year_drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", year, drug) %>%
  factor_dims(year, drug)
```

`r text_threshold(data = year_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "drug"))`

(ref:year-drug) 各年份各农药检出率与合格率

```{r year-drug-table, results="asis", dev='png'}
sp_dable(year_drug, ref_text = "(ref:year-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(drug)` 种农药每年的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-drug-det-eheatmap) 和图 \@ref(fig:year-drug-def-eheatmap)。可以看出，`r nrow(drug)` 种农药每年的抽检样本量在 `r text_range(year_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_drug, "qualification_rate_percent")` 之间。

```{r year-drug-det-eheatmap, fig.cap="各年份各农药检出率热力图"}
heatmap(
  year_drug,
  x_var = "drug", y_var = "year", value_var = "detection_rate_percent",
  height = "300%", x_label_fontsize = 11, shrink_height = "35%"
)
```

```{r year-drug-def-eheatmap, fig.cap="各年份各农药超标率热力图"}
heatmap(
  year_drug %>% change_to_defective(),
  x_var = "drug", y_var = "year", value_var = "defective_rate_percent",
  height = "300%", x_label_fontsize = 11, shrink_height = "35%"
)
```

## “季度-药品”残留风险

```{r quarter-drug}
quarter_drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", quarter, drug) %>%
  factor_dims(quarter, drug)
```

`r text_threshold(data = quarter_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "drug"))`

(ref:quarter-drug) 各季度各农药检出率与合格率

```{r quarter-drug-table, results="asis", dev='png'}
sp_dable(quarter_drug, ref_text = "(ref:quarter-drug)")
```

&emsp;&emsp;表 \@ref(tab:quarter-drug) 给出了 `r nrow(drug)` 种农药每季度的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:quarter-drug-det-eheatmap) 和图 \@ref(fig:quarter-drug-def-eheatmap)。可以看出，`r nrow(drug)` 种农药每季度的抽检样本量在 `r text_range(quarter_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_drug, "qualification_rate_percent")` 之间。

```{r quarter-drug-det-eheatmap, fig.cap="各季度各农药检出率热力图"}
heatmap(
  quarter_drug,
  x_var = "drug", y_var = "quarter", value_var = "detection_rate_percent",
  height = "300%", x_label_fontsize = 11, shrink_height = "35%"
)
```

```{r quarter-drug-def-eheatmap, fig.cap="各季度各农药超标率热力图"}
heatmap(
  quarter_drug %>% change_to_defective(),
  x_var = "drug", y_var = "quarter", value_var = "defective_rate_percent",
  height = "300%", x_label_fontsize = 11, shrink_height = "35%"
)
```

## “省份-药品”残留风险

```{r province-drug}
province_drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", province, drug) %>%
  factor_dims(province, drug)
```

`r text_threshold(data = province_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("province", "drug"))`

(ref:province-drug) 各省份各农药检出率与合格率

```{r province-drug-table, results="asis", dev='png'}
sp_dable(province_drug, ref_text = "(ref:province-drug)")
```

&emsp;&emsp;表 \@ref(tab:province-drug) 给出了 `r nrow(province)` 个省市自治区对 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:province-drug-det-eheatmap) 和图 \@ref(fig:province-drug-def-eheatmap)。可以看出，各省份各农药的抽检样本量在 `r text_range(province_drug, "sample_size")` 之间，检出率稳定在 `r text_range(province_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(province_drug, "qualification_rate_percent")` 之间。

```{r province-drug-det-eheatmap, fig.cap="各省份各农药检出率热力图"}
heatmap(
  province_drug %>% shorten_province_name(),
  x_var = "drug", y_var = "province", value_var = "detection_rate_percent",
  x_label_fontsize = 11, shrink_height = "73%"
)
```

```{r province-drug-def-eheatmap, fig.cap="各省份各农药超标率热力图"}
heatmap(
  province_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "province", value_var = "defective_rate_percent",
  x_label_fontsize = 11, shrink_height = "73%"
)
```

## “蔬菜类别-药品”残留风险

```{r category-drug}
category_drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", category, drug) %>%
  factor_dims(category, drug)
```

`r text_threshold(data = category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("category", "drug"))`

(ref:category-drug) 各蔬菜类别各农药检出率与合格率

```{r category-drug-table, results="asis", dev='png'}
sp_dable(category_drug, ref_text = "(ref:category-drug)")
```

&emsp;&emsp;表 \@ref(tab:category-drug) 给出了 `r nrow(drug)` 种农药在 `r nrow(category)` 个蔬菜类别上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:category-drug-det-eheatmap) 和图 \@ref(fig:category-drug-def-eheatmap)。可以看出，各蔬菜类别各农药的抽检样本量在 `r text_range(category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(category_drug, "qualification_rate_percent")` 之间。

```{r category-drug-det-eheatmap, fig.cap="各蔬菜类别各农药检出率热力图"}
heatmap(
  category_drug,
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%", shrink_height = "50%"
)
```

```{r category-drug-def-eheatmap, fig.cap="各蔬菜类别各农药超标率热力图"}
heatmap(
  category_drug %>% change_to_defective(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%", shrink_height = "50%"
)
```

## “品种-药品”残留风险

```{r product-drug}
product_drug <- spec_dataset(dims_comb_data, dims, ana_threshold, "product_drug", product, drug) %>%
  factor_dims(product, drug)
```

`r text_threshold(data = product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("product", "drug"))`

(ref:product-drug) 各品种各农药检出率与合格率

```{r product-drug-table, results="asis", dev='png'}
sp_dable(product_drug, ref_text = "(ref:product-drug)")
```

&emsp;&emsp;表 \@ref(tab:product-drug) 给出了 `r nrow(drug)` 种农药在 `r nrow(product)` 个蔬菜品种上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:product-drug-det-eheatmap) 和图 \@ref(fig:product-drug-def-eheatmap)。可以看出，各品种各农药的抽检样本量在 `r text_range(product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug, "qualification_rate_percent")` 之间。

```{r product-drug-det-eheatmap, fig.cap="各品种各药物检出率热力图"}
heatmap(
  product_drug,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "800%", shrink_height = "75%"
)
```

```{r product-drug-def-eheatmap, fig.cap="各品种各药物超标率热力图"}
heatmap(
  product_drug %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "800%", shrink_height = "75%"
)
```

## “年份-季度-药品”残留风险

```{r year-quarter-drug}
year_quarter_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, drug
)
```

`r text_threshold(data = year_quarter_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "drug"))`

(ref:year-quarter-drug) 各年份各季度各农药检出率与合格率

```{r year-quarter-drug-table, results="asis", dev='png'}
sp_dable(
  year_quarter_drug %>% factor_dims(year, quarter, drug), 
  ref_text = "(ref:year-quarter-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年第一季度到第四季度 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-drug-det-eheatmap) 和图 \@ref(fig:year-quarter-drug-def-eheatmap)。可以看出，各年份各季度各农药的抽检样本量在 `r text_range(year_quarter_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-drug-det-eheatmap, fig.cap="各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_drug %>% combine_year_quarter(),
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度",
  x_label_fontsize = 11, height = "600%", shrink_height = "65%"
)
```

```{r year-quarter-drug-def-eheatmap, fig.cap="各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_drug %>% combine_year_quarter() %>% change_to_defective(),
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "600%", shrink_height = "65%"
)
```

## “年份-省份-药品”残留风险

```{r year-province-drug}
year_province_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, province, drug
) %>%
  factor_dims(year, province, drug)
```

`r text_threshold(data = year_province_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province", "drug"))`

(ref:year-province-drug) 各年份各省份各农药检出率与合格率

```{r year-province-drug-table, results="asis", dev='png'}
sp_dable(year_province_drug, ref_text = "(ref:year-province-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-province-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(province)` 个省市自治区的 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-province-drug-det-eheatmap) 和图 \@ref(fig:year-province-drug-def-eheatmap)。可以看出，各年份各省份各农药的抽检样本量在 `r text_range(year_province_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_province_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_province_drug, "qualification_rate_percent")` 之间。

```{r year-province-drug-det-eheatmap, fig.cap="各年份各省份各农药检出率热力图"}
heatmap(
  year_province_drug %>% shorten_province_name(), timeline_var = "year",
  x_var = "drug", y_var = "province", value_var = "detection_rate_percent",
  x_label_fontsize = 11, shrink_height = "70%"
)
```

```{r year-province-drug-def-eheatmap, fig.cap="各年份各省份各农药超标率热力图"}
heatmap(
  year_province_drug %>% change_to_defective() %>% shorten_province_name(), 
  timeline_var = "year",
  x_var = "drug", y_var = "province", value_var = "defective_rate_percent",
  x_label_fontsize = 11, shrink_height = "70%"
)
```

## “年份-蔬菜类别-药品”残留风险

```{r year-category-drug}
year_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, category, drug
) %>%
  factor_dims(year, category, drug)
```

`r text_threshold(data = year_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "category", "drug"))`

(ref:year-category-drug) 各年份各蔬菜类别各农药检出率与合格率

```{r year-category-drug-table, results="asis", dev='png'}
sp_dable(year_category_drug, ref_text = "(ref:year-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-category-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(category)` 个蔬菜类别的 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-category-drug-det-eheatmap) 和图 \@ref(fig:year-category-drug-def-eheatmap)。可以看出，各年份各蔬菜类别各农药的抽检样本量在 `r text_range(year_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_category_drug, "qualification_rate_percent")` 之间。

```{r year-category-drug-det-eheatmap, fig.cap="各年份各蔬菜类别各药物检出率热力图"}
heatmap(
  year_category_drug, timeline_var = "year",
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  height = "400%", x_label_fontsize = 11
)
```

```{r year-category-drug-def-eheatmap, fig.cap="各年份各蔬菜类别各药物超标率热力图"}
heatmap(
  year_category_drug %>% change_to_defective(), timeline_var = "year",
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  height = "400%", x_label_fontsize = 11
)
```

## “年份-品种-药品”残留风险

> 热力图缺少黑木耳与茶树菇（2019年）的数据

```{r year-product-drug}
year_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, product, drug
) %>%
  factor_dims(year, product, drug)
```

`r text_threshold(data = year_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "product", "drug"))`

(ref:year-product-drug) 各年份各品种各农药检出率与合格率

```{r year-product-drug-table, results="asis", dev='png'}
sp_dable(year_product_drug, ref_text = "(ref:year-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-product-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(product)` 个蔬菜品种的 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-product-drug-det-eheatmap) 和图 \@ref(fig:year-product-drug-def-eheatmap)。可以看出，各年份各蔬菜品种各农药的抽检样本量在 `r text_range(year_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_product_drug, "qualification_rate_percent")` 之间。

```{r year-product-drug-det-eheatmap, fig.cap="各年份各品种各药物检出率热力图"}
heatmap(
  year_product_drug, timeline_var = "year",
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11
)
```

```{r year-product-drug-def-eheatmap, fig.cap="各年份各品种各药物超标率热力图"}
heatmap(
  year_product_drug %>% change_to_defective(), timeline_var = "year",
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11
)
```

## “季度-省份-药品”残留风险

```{r quarter-province-drug}
quarter_province_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  quarter, province, drug
) %>%
  factor_dims(quarter, province, drug)
```

`r text_threshold(data = quarter_province_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province", "drug"))`

(ref:quarter-province-drug) 各季度各省份各农药检出率与合格率

```{r quarter-province-drug-table, results="asis", dev='png'}
sp_dable(quarter_province_drug, ref_text = "(ref:quarter-province-drug)")
```

&emsp;&emsp;表 \@ref(tab:quarter-province-drug) 给出了 `r nrow(province)` 个省市自治区在四个季度的 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:quarter-province-drug-det-eheatmap) 和图 \@ref(fig:quarter-province-drug-def-eheatmap)。可以看出，各季度各省份各农药的抽检样本量在 `r text_range(quarter_province_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_province_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_province_drug, "qualification_rate_percent")` 之间。

```{r quarter-province-drug-det-eheatmap, fig.cap="各季度各省份各药物检出率热力图"}
heatmap(
  quarter_province_drug %>% shorten_province_name(), timeline_var = "quarter",
  x_var = "drug", y_var = "province", value_var = "detection_rate_percent",
  x_label_fontsize = 11
)
```

```{r quarter-province-drug-def-eheatmap, fig.cap="各季度各省份各药物超标率热力图"}
heatmap(
  quarter_province_drug %>% change_to_defective() %>% shorten_province_name(), 
  timeline_var = "quarter",
  x_var = "drug", y_var = "province", value_var = "defective_rate_percent"
)
```

## “季度-蔬菜类别-药品”残留风险

```{r quarter-category-drug}
quarter_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  quarter, category, drug
) %>%
  factor_dims(quarter, category, drug)
```

`r text_threshold(data = quarter_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "category", "drug"))`

(ref:quarter-category-drug) 各季度各蔬菜类别各农药检出率与合格率

```{r quarter-category-drug-table, results="asis", dev='png'}
sp_dable(quarter_category_drug, ref_text = "(ref:quarter-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:quarter-category-drug) 给出了 `r nrow(category)` 个蔬菜类别在四个季度的 `r nrow(drug)` 种农药的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:quarter-category-drug-det-eheatmap) 和图 \@ref(fig:quarter-category-drug-def-eheatmap)。可以看出，各季度各蔬菜类别各农药的抽检样本量在 `r text_range(quarter_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_category_drug, "qualification_rate_percent")` 之间。

```{r quarter-category-drug-det-eheatmap, fig.cap="各季度各蔬菜类别各药物检出率热力图"}
heatmap(
  quarter_category_drug, timeline_var = "quarter",
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r quarter-category-drug-def-eheatmap, fig.cap="各季度各蔬菜类别各药物超标率热力图"}
heatmap(
  quarter_category_drug %>% change_to_defective(), timeline_var = "quarter",
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

## “季度-品种-药品”残留风险

```{r quarter-product-drug}
quarter_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  quarter, product, drug
) %>%
  factor_dims(quarter, product, drug)
```

`r text_threshold(data = quarter_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "product", "drug"))`

(ref:quarter-product-drug) 各季度各品种各农药检出率与合格率

```{r quarter-product-drug-table, results="asis", dev='png'}
sp_dable(quarter_product_drug, ref_text = "(ref:quarter-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:quarter-product-drug) 给出了四个季度种 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各季度各蔬菜品种各农药的抽检样本量在 `r text_range(quarter_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_product_drug, "qualification_rate_percent")` 之间。

```{r Q1-product-drug-det-eheatmap, fig.cap="第一季度各品种各药物检出率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第一季度"),
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent", 
  x_label_fontsize = 11
)
```

```{r Q2-product-drug-det-eheatmap, fig.cap="第二季度各品种各药物检出率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第二季度"),
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent", 
  x_label_fontsize = 11
)
```

```{r Q3-product-drug-det-eheatmap, fig.cap="第三季度各品种各药物检出率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第三季度"),
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent", 
  x_label_fontsize = 11
)
```

```{r Q4-product-drug-det-eheatmap, fig.cap="第四季度各品种各药物检出率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第四季度"),
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent", 
  x_label_fontsize = 11
)
```

```{r Q1-product-drug-def-eheatmap, fig.cap="第一季度各品种各药物超标率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第一季度") %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11
)
```

```{r Q2-product-drug-def-eheatmap, fig.cap="第二季度各品种各药物超标率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第二季度") %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11
)
```

```{r Q3-product-drug-def-eheatmap, fig.cap="第三季度各品种各药物超标率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第三季度") %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11
)
```

```{r Q4-product-drug-def-eheatmap, fig.cap="第四季度各品种各药物超标率热力图"}
heatmap(
  quarter_product_drug %>% filter(quarter == "第四季度") %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11
)
```

## “省份-蔬菜类别-药品”残留风险

```{r province-category-drug}
province_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  province, category, drug
) %>%
  factor_dims(province, category, drug)
```

`r text_threshold(data = province_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("province", "category", "drug"))`

(ref:province-category-drug) 各省份各蔬菜类别各农药检出率与合格率

```{r province-category-drug-table, results="asis", dev='png', eval=FALSE}
sp_dable(province_category_drug, ref_text = "(ref:province-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:anhui-category-drug) - 表 \@ref(tab:chongqing-category-drug) 给出了 `r nrow(province)` 个省市自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:anhui-category-drug-det-eheatmap) - 图 \@ref(fig:chongqing-category-drug-def-eheatmap)。可以看出，各省市自治区各蔬菜类别各农药的抽检样本量在 `r text_range(province_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(province_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(province_category_drug, "qualification_rate_percent")` 之间。

### 安徽省

```{r anhui-category-drug}
anhui_category_drug <- province_category_drug %>%
  filter(province == "安徽省")
```

(ref:anhui-category-drug) 安徽省各蔬菜类别各农药检出率与合格率

```{r anhui-category-drug-table, results="asis", dev='png'}
sp_dable(anhui_category_drug, ref_text = "(ref:anhui-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:anhui-category-drug) 给出了安徽省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:anhui-category-drug-det-eheatmap) - 图 \@ref(fig:anhui-category-drug-def-eheatmap)。可以看出，安徽省各蔬菜类别各农药的抽检样本量在 `r text_range(anhui_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(anhui_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(anhui_category_drug, "qualification_rate_percent")` 之间。

```{r anhui-category-drug-det-eheatmap, fig.cap="安徽省各蔬菜类别各药物检出率热力图"}
heatmap(
  anhui_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r anhui-category-drug-def-eheatmap, fig.cap="安徽省各蔬菜类别各药物超标率热力图"}
heatmap(
  anhui_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 北京市

```{r beijing-category-drug}
beijing_category_drug <- province_category_drug %>%
  filter(province == "北京市")
```

(ref:beijing-category-drug) 北京市各蔬菜类别各农药检出率与合格率

```{r beijing-category-drug-table, results="asis", dev='png'}
sp_dable(beijing_category_drug, ref_text = "(ref:beijing-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:beijing-category-drug) 给出了北京市的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:beijing-category-drug-det-eheatmap) - 图 \@ref(fig:beijing-category-drug-def-eheatmap)。可以看出，北京市各蔬菜类别各农药的抽检样本量在 `r text_range(beijing_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(beijing_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(beijing_category_drug, "qualification_rate_percent")` 之间。

```{r beijing-category-drug-det-eheatmap, fig.cap="北京市各蔬菜类别各药物检出率热力图"}
heatmap(
  beijing_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r beijing-category-drug-def-eheatmap, fig.cap="北京市各蔬菜类别各药物超标率热力图"}
heatmap(
  beijing_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 福建省

```{r fujian-category-drug}
fujian_category_drug <- province_category_drug %>%
  filter(province == "福建省")
```

(ref:fujian-category-drug) 福建省各蔬菜类别各农药检出率与合格率

```{r fujian-category-drug-table, results="asis", dev='png'}
sp_dable(fujian_category_drug, ref_text = "(ref:fujian-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:fujian-category-drug) 给出了福建省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:fujian-category-drug-det-eheatmap) - 图 \@ref(fig:fujian-category-drug-def-eheatmap)。可以看出，福建省各蔬菜类别各农药的抽检样本量在 `r text_range(fujian_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(fujian_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(fujian_category_drug, "qualification_rate_percent")` 之间。

```{r fujian-category-drug-det-eheatmap, fig.cap="福建省各蔬菜类别各药物检出率热力图"}
heatmap(
  fujian_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r fujian-category-drug-def-eheatmap, fig.cap="福建省各蔬菜类别各药物超标率热力图"}
heatmap(
  fujian_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 甘肃省

```{r gansu-category-drug}
gansu_category_drug <- province_category_drug %>%
  filter(province == "甘肃省")
```

(ref:gansu-category-drug) 甘肃省各蔬菜类别各农药检出率与合格率

```{r gansu-category-drug-table, results="asis", dev='png'}
sp_dable(gansu_category_drug, ref_text = "(ref:gansu-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:gansu-category-drug) 给出了甘肃省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:gansu-category-drug-det-eheatmap) - 图 \@ref(fig:gansu-category-drug-def-eheatmap)。可以看出，甘肃省各蔬菜类别各农药的抽检样本量在 `r text_range(gansu_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(gansu_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(gansu_category_drug, "qualification_rate_percent")` 之间。

```{r gansu-category-drug-det-eheatmap, fig.cap="甘肃省各蔬菜类别各药物检出率热力图"}
heatmap(
  gansu_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r gansu-category-drug-def-eheatmap, fig.cap="甘肃省各蔬菜类别各药物超标率热力图"}
heatmap(
  gansu_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 广东省

```{r guangdong-category-drug}
guangdong_category_drug <- province_category_drug %>%
  filter(province == "广东省")
```

(ref:guangdong-category-drug) 广东省各蔬菜类别各农药检出率与合格率

```{r guangdong-category-drug-table, results="asis", dev='png'}
sp_dable(guangdong_category_drug, ref_text = "(ref:guangdong-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:guangdong-category-drug) 给出了广东省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guangdong-category-drug-det-eheatmap) - 图 \@ref(fig:guangdong-category-drug-def-eheatmap)。可以看出，广东省各蔬菜类别各农药的抽检样本量在 `r text_range(guangdong_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guangdong_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guangdong_category_drug, "qualification_rate_percent")` 之间。

```{r guangdong-category-drug-det-eheatmap, fig.cap="广东省各蔬菜类别各药物检出率热力图"}
heatmap(
  guangdong_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guangdong-category-drug-def-eheatmap, fig.cap="广东省各蔬菜类别各药物超标率热力图"}
heatmap(
  guangdong_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 广西壮族自治区

```{r guangxi-category-drug}
guangxi_category_drug <- province_category_drug %>%
  filter(province == "广西壮族自治区")
```

(ref:guangxi-category-drug) 广西壮族自治区各蔬菜类别各农药检出率与合格率

```{r guangxi-category-drug-table, results="asis", dev='png'}
sp_dable(guangxi_category_drug, ref_text = "(ref:guangxi-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:guangxi-category-drug) 给出了广西壮族自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guangxi-category-drug-det-eheatmap) - 图 \@ref(fig:guangxi-category-drug-def-eheatmap)。可以看出，广西壮族自治区各蔬菜类别各农药的抽检样本量在 `r text_range(guangxi_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guangxi_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guangxi_category_drug, "qualification_rate_percent")` 之间。

```{r guangxi-category-drug-det-eheatmap, fig.cap="广西壮族自治区各蔬菜类别各药物检出率热力图"}
heatmap(
  guangxi_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guangxi-category-drug-def-eheatmap, fig.cap="广西壮族自治区各蔬菜类别各药物超标率热力图"}
heatmap(
  guangxi_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 贵州省

```{r guizhou-category-drug}
guizhou_category_drug <- province_category_drug %>%
  filter(province == "贵州省")
```

(ref:guizhou-category-drug) 贵州省各蔬菜类别各农药检出率与合格率

```{r guizhou-category-drug-table, results="asis", dev='png'}
sp_dable(guizhou_category_drug, ref_text = "(ref:guizhou-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:guizhou-category-drug) 给出了贵州省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guizhou-category-drug-det-eheatmap) - 图 \@ref(fig:guizhou-category-drug-def-eheatmap)。可以看出，贵州省各蔬菜类别各农药的抽检样本量在 `r text_range(guizhou_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guizhou_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guizhou_category_drug, "qualification_rate_percent")` 之间。

```{r guizhou-category-drug-det-eheatmap, fig.cap="贵州省各蔬菜类别各药物检出率热力图"}
heatmap(
  guizhou_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guizhou-category-drug-def-eheatmap, fig.cap="贵州省各蔬菜类别各药物超标率热力图"}
heatmap(
  guizhou_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 海南省

```{r hainan-category-drug}
hainan_category_drug <- province_category_drug %>%
  filter(province == "海南省")
```

(ref:hainan-category-drug) 海南省各蔬菜类别各农药检出率与合格率

```{r hainan-category-drug-table, results="asis", dev='png'}
sp_dable(hainan_category_drug, ref_text = "(ref:hainan-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:hainan-category-drug) 给出了海南省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hainan-category-drug-det-eheatmap) - 图 \@ref(fig:hainan-category-drug-def-eheatmap)。可以看出，海南省各蔬菜类别各农药的抽检样本量在 `r text_range(hainan_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hainan_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hainan_category_drug, "qualification_rate_percent")` 之间。

```{r hainan-category-drug-det-eheatmap, fig.cap="海南省各蔬菜类别各药物检出率热力图"}
heatmap(
  hainan_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hainan-category-drug-def-eheatmap, fig.cap="海南省各蔬菜类别各药物超标率热力图"}
heatmap(
  hainan_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 河北省

```{r hebei-category-drug}
hebei_category_drug <- province_category_drug %>%
  filter(province == "河北省")
```

(ref:hebei-category-drug) 河北省各蔬菜类别各农药检出率与合格率

```{r hebei-category-drug-table, results="asis", dev='png'}
sp_dable(hebei_category_drug, ref_text = "(ref:hebei-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:hebei-category-drug) 给出了河北省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hebei-category-drug-det-eheatmap) - 图 \@ref(fig:hebei-category-drug-def-eheatmap)。可以看出，河北省各蔬菜类别各农药的抽检样本量在 `r text_range(hebei_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hebei_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hebei_category_drug, "qualification_rate_percent")` 之间。

```{r hebei-category-drug-det-eheatmap, fig.cap="河北省各蔬菜类别各药物检出率热力图"}
heatmap(
  hebei_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hebei-category-drug-def-eheatmap, fig.cap="河北省各蔬菜类别各药物超标率热力图"}
heatmap(
  hebei_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 河南省

```{r henan-category-drug}
henan_category_drug <- province_category_drug %>%
  filter(province == "河南省")
```

(ref:henan-category-drug) 河南省各蔬菜类别各农药检出率与合格率

```{r henan-category-drug-table, results="asis", dev='png'}
sp_dable(henan_category_drug, ref_text = "(ref:henan-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:henan-category-drug) 给出了河南省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:henan-category-drug-det-eheatmap) - 图 \@ref(fig:henan-category-drug-def-eheatmap)。可以看出，河南省各蔬菜类别各农药的抽检样本量在 `r text_range(henan_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(henan_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(henan_category_drug, "qualification_rate_percent")` 之间。

```{r henan-category-drug-det-eheatmap, fig.cap="河南省各蔬菜类别各药物检出率热力图"}
heatmap(
  henan_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r henan-category-drug-def-eheatmap, fig.cap="河南省各蔬菜类别各药物超标率热力图"}
heatmap(
  henan_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 黑龙江省

```{r heilongjiang-category-drug}
heilongjiang_category_drug <- province_category_drug %>%
  filter(province == "黑龙江省")
```

(ref:heilongjiang-category-drug) 黑龙江省各蔬菜类别各农药检出率与合格率

```{r heilongjiang-category-drug-table, results="asis", dev='png'}
sp_dable(heilongjiang_category_drug, ref_text = "(ref:heilongjiang-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:heilongjiang-category-drug) 给出了黑龙江省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:heilongjiang-category-drug-det-eheatmap) - 图 \@ref(fig:heilongjiang-category-drug-def-eheatmap)。可以看出，黑龙江省各蔬菜类别各农药的抽检样本量在 `r text_range(heilongjiang_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(heilongjiang_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(heilongjiang_category_drug, "qualification_rate_percent")` 之间。

```{r heilongjiang-category-drug-det-eheatmap, fig.cap="黑龙江省各蔬菜类别各药物检出率热力图"}
heatmap(
  heilongjiang_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r heilongjiang-category-drug-def-eheatmap, fig.cap="黑龙江省各蔬菜类别各药物超标率热力图"}
heatmap(
  heilongjiang_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 湖北省

```{r hubei-category-drug}
hubei_category_drug <- province_category_drug %>%
  filter(province == "湖北省")
```

(ref:hubei-category-drug) 湖北省各蔬菜类别各农药检出率与合格率

```{r hubei-category-drug-table, results="asis", dev='png'}
sp_dable(hubei_category_drug, ref_text = "(ref:hubei-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:hubei-category-drug) 给出了湖北省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hubei-category-drug-det-eheatmap) - 图 \@ref(fig:hubei-category-drug-def-eheatmap)。可以看出，湖北省各蔬菜类别各农药的抽检样本量在 `r text_range(hubei_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hubei_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hubei_category_drug, "qualification_rate_percent")` 之间。

```{r hubei-category-drug-det-eheatmap, fig.cap="湖北省各蔬菜类别各药物检出率热力图"}
heatmap(
  hubei_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hubei-category-drug-def-eheatmap, fig.cap="湖北省各蔬菜类别各药物超标率热力图"}
heatmap(
  hubei_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 湖南省

```{r hunan-category-drug}
hunan_category_drug <- province_category_drug %>%
  filter(province == "湖南省")
```

(ref:hunan-category-drug) 湖南省各蔬菜类别各农药检出率与合格率

```{r hunan-category-drug-table, results="asis", dev='png'}
sp_dable(hunan_category_drug, ref_text = "(ref:hunan-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:hunan-category-drug) 给出了湖南省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hunan-category-drug-det-eheatmap) - 图 \@ref(fig:hunan-category-drug-def-eheatmap)。可以看出，湖南省各蔬菜类别各农药的抽检样本量在 `r text_range(hunan_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hunan_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hunan_category_drug, "qualification_rate_percent")` 之间。

```{r hunan-category-drug-det-eheatmap, fig.cap="湖南省各蔬菜类别各药物检出率热力图"}
heatmap(
  hunan_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hunan-category-drug-def-eheatmap, fig.cap="湖南省各蔬菜类别各药物超标率热力图"}
heatmap(
  hunan_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 吉林省

```{r jiling-category-drug}
jiling_category_drug <- province_category_drug %>%
  filter(province == "吉林省")
```

(ref:jiling-category-drug) 吉林省各蔬菜类别各农药检出率与合格率

```{r jiling-category-drug-table, results="asis", dev='png'}
sp_dable(jiling_category_drug, ref_text = "(ref:jiling-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiling-category-drug) 给出了吉林省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiling-category-drug-det-eheatmap) - 图 \@ref(fig:jiling-category-drug-def-eheatmap)。可以看出，吉林省各蔬菜类别各农药的抽检样本量在 `r text_range(jiling_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiling_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiling_category_drug, "qualification_rate_percent")` 之间。

```{r jiling-category-drug-det-eheatmap, fig.cap="吉林省各蔬菜类别各药物检出率热力图"}
heatmap(
  jiling_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiling-category-drug-def-eheatmap, fig.cap="吉林省各蔬菜类别各药物超标率热力图"}
heatmap(
  jiling_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 江苏省

```{r jiangsu-category-drug}
jiangsu_category_drug <- province_category_drug %>%
  filter(province == "江苏省")
```

(ref:jiangsu-category-drug) 江苏省各蔬菜类别各农药检出率与合格率

```{r jiangsu-category-drug-table, results="asis", dev='png'}
sp_dable(jiangsu_category_drug, ref_text = "(ref:jiangsu-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiangsu-category-drug) 给出了江苏省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiangsu-category-drug-det-eheatmap) - 图 \@ref(fig:jiangsu-category-drug-def-eheatmap)。可以看出，江苏省各蔬菜类别各农药的抽检样本量在 `r text_range(jiangsu_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiangsu_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiangsu_category_drug, "qualification_rate_percent")` 之间。

```{r jiangsu-category-drug-det-eheatmap, fig.cap="江苏省各蔬菜类别各药物检出率热力图"}
heatmap(
  jiangsu_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiangsu-category-drug-def-eheatmap, fig.cap="江苏省各蔬菜类别各药物超标率热力图"}
heatmap(
  jiangsu_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 江西省

```{r jiangxi-category-drug}
jiangxi_category_drug <- province_category_drug %>%
  filter(province == "江西省")
```

(ref:jiangxi-category-drug) 江西省各蔬菜类别各农药检出率与合格率

```{r jiangxi-category-drug-table, results="asis", dev='png'}
sp_dable(jiangxi_category_drug, ref_text = "(ref:jiangxi-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiangxi-category-drug) 给出了江西省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiangxi-category-drug-det-eheatmap) - 图 \@ref(fig:jiangxi-category-drug-def-eheatmap)。可以看出，江西省各蔬菜类别各农药的抽检样本量在 `r text_range(jiangxi_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiangxi_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiangxi_category_drug, "qualification_rate_percent")` 之间。

```{r jiangxi-category-drug-det-eheatmap, fig.cap="江西省各蔬菜类别各药物检出率热力图"}
heatmap(
  jiangxi_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiangxi-category-drug-def-eheatmap, fig.cap="江西省各蔬菜类别各药物超标率热力图"}
heatmap(
  jiangxi_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 辽宁省

```{r liaoning-category-drug}
liaoning_category_drug <- province_category_drug %>%
  filter(province == "辽宁省")
```

(ref:liaoning-category-drug) 辽宁省各蔬菜类别各农药检出率与合格率

```{r liaoning-category-drug-table, results="asis", dev='png'}
sp_dable(liaoning_category_drug, ref_text = "(ref:liaoning-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:liaoning-category-drug) 给出了辽宁省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:liaoning-category-drug-det-eheatmap) - 图 \@ref(fig:liaoning-category-drug-def-eheatmap)。可以看出，辽宁省各蔬菜类别各农药的抽检样本量在 `r text_range(liaoning_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(liaoning_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(liaoning_category_drug, "qualification_rate_percent")` 之间。

```{r liaoning-category-drug-det-eheatmap, fig.cap="辽宁省各蔬菜类别各药物检出率热力图"}
heatmap(
  liaoning_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r liaoning-category-drug-def-eheatmap, fig.cap="辽宁省各蔬菜类别各药物超标率热力图"}
heatmap(
  liaoning_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 内蒙古自治区

```{r neimenggu-category-drug}
neimenggu_category_drug <- province_category_drug %>%
  filter(province == "内蒙古自治区")
```

(ref:neimenggu-category-drug) 内蒙古自治区各蔬菜类别各农药检出率与合格率

```{r neimenggu-category-drug-table, results="asis", dev='png'}
sp_dable(neimenggu_category_drug, ref_text = "(ref:neimenggu-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:neimenggu-category-drug) 给出了内蒙古自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:neimenggu-category-drug-det-eheatmap) - 图 \@ref(fig:neimenggu-category-drug-def-eheatmap)。可以看出，内蒙古自治区各蔬菜类别各农药的抽检样本量在 `r text_range(neimenggu_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(neimenggu_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(neimenggu_category_drug, "qualification_rate_percent")` 之间。

```{r neimenggu-category-drug-det-eheatmap, fig.cap="内蒙古自治区各蔬菜类别各药物检出率热力图"}
heatmap(
  neimenggu_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r neimenggu-category-drug-def-eheatmap, fig.cap="内蒙古自治区各蔬菜类别各药物超标率热力图"}
heatmap(
  neimenggu_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 宁夏回族自治区

```{r ningxia-category-drug}
ningxia_category_drug <- province_category_drug %>%
  filter(province == "宁夏回族自治区")
```

(ref:ningxia-category-drug) 宁夏回族自治区各蔬菜类别各农药检出率与合格率

```{r ningxia-category-drug-table, results="asis", dev='png'}
sp_dable(ningxia_category_drug, ref_text = "(ref:ningxia-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:ningxia-category-drug) 给出了宁夏回族自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:ningxia-category-drug-det-eheatmap) - 图 \@ref(fig:ningxia-category-drug-def-eheatmap)。可以看出，宁夏回族自治区各蔬菜类别各农药的抽检样本量在 `r text_range(ningxia_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(ningxia_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(ningxia_category_drug, "qualification_rate_percent")` 之间。

```{r ningxia-category-drug-det-eheatmap, fig.cap="宁夏回族自治区各蔬菜类别各药物检出率热力图"}
heatmap(
  ningxia_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r ningxia-category-drug-def-eheatmap, fig.cap="宁夏回族自治区各蔬菜类别各药物超标率热力图"}
heatmap(
  ningxia_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 青海省

```{r qinghai-category-drug}
qinghai_category_drug <- province_category_drug %>%
  filter(province == "青海省")
```

(ref:qinghai-category-drug) 青海省各蔬菜类别各农药检出率与合格率

```{r qinghai-category-drug-table, results="asis", dev='png'}
sp_dable(qinghai_category_drug, ref_text = "(ref:qinghai-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:qinghai-category-drug) 给出了青海省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:qinghai-category-drug-det-eheatmap) - 图 \@ref(fig:qinghai-category-drug-def-eheatmap)。可以看出，青海省各蔬菜类别各农药的抽检样本量在 `r text_range(qinghai_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(qinghai_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(qinghai_category_drug, "qualification_rate_percent")` 之间。

```{r qinghai-category-drug-det-eheatmap, fig.cap="青海省各蔬菜类别各药物检出率热力图"}
heatmap(
  qinghai_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r qinghai-category-drug-def-eheatmap, fig.cap="青海省各蔬菜类别各药物超标率热力图"}
heatmap(
  qinghai_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 山东省

```{r shandong-category-drug}
shandong_category_drug <- province_category_drug %>%
  filter(province == "山东省")
```

(ref:shandong-category-drug) 山东省各蔬菜类别各农药检出率与合格率

```{r shandong-category-drug-table, results="asis", dev='png'}
sp_dable(shandong_category_drug, ref_text = "(ref:shandong-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:shandong-category-drug) 给出了山东省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shandong-category-drug-det-eheatmap) - 图 \@ref(fig:shandong-category-drug-def-eheatmap)。可以看出，山东省各蔬菜类别各农药的抽检样本量在 `r text_range(shandong_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shandong_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shandong_category_drug, "qualification_rate_percent")` 之间。

```{r shandong-category-drug-det-eheatmap, fig.cap="山东省各蔬菜类别各药物检出率热力图"}
heatmap(
  shandong_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shandong-category-drug-def-eheatmap, fig.cap="山东省各蔬菜类别各药物超标率热力图"}
heatmap(
  shandong_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 山西省

```{r shan1xi-category-drug}
shan1xi_category_drug <- province_category_drug %>%
  filter(province == "山西省")
```

(ref:shan1xi-category-drug) 山西省各蔬菜类别各农药检出率与合格率

```{r shan1xi-category-drug-table, results="asis", dev='png'}
sp_dable(shan1xi_category_drug, ref_text = "(ref:shan1xi-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:shan1xi-category-drug) 给出了山西省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shan1xi-category-drug-det-eheatmap) - 图 \@ref(fig:shan1xi-category-drug-def-eheatmap)。可以看出，山西省各蔬菜类别各农药的抽检样本量在 `r text_range(shan1xi_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shan1xi_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shan1xi_category_drug, "qualification_rate_percent")` 之间。

```{r shan1xi-category-drug-det-eheatmap, fig.cap="山西省各蔬菜类别各药物检出率热力图"}
heatmap(
  shan1xi_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shan1xi-category-drug-def-eheatmap, fig.cap="山西省各蔬菜类别各药物超标率热力图"}
heatmap(
  shan1xi_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 陕西省

```{r shan3xi-category-drug}
shan3xi_category_drug <- province_category_drug %>%
  filter(province == "陕西省")
```

(ref:shan3xi-category-drug) 陕西省各蔬菜类别各农药检出率与合格率

```{r shan3xi-category-drug-table, results="asis", dev='png'}
sp_dable(shan3xi_category_drug, ref_text = "(ref:shan3xi-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:shan3xi-category-drug) 给出了陕西省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shan3xi-category-drug-det-eheatmap) - 图 \@ref(fig:shan3xi-category-drug-def-eheatmap)。可以看出，陕西省各蔬菜类别各农药的抽检样本量在 `r text_range(shan3xi_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shan3xi_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shan3xi_category_drug, "qualification_rate_percent")` 之间。

```{r shan3xi-category-drug-det-eheatmap, fig.cap="陕西省各蔬菜类别各药物检出率热力图"}
heatmap(
  shan3xi_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shan3xi-category-drug-def-eheatmap, fig.cap="陕西省各蔬菜类别各药物超标率热力图"}
heatmap(
  shan3xi_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 上海市

```{r shanghai-category-drug}
shanghai_category_drug <- province_category_drug %>%
  filter(province == "上海市")
```

(ref:shanghai-category-drug) 上海市各蔬菜类别各农药检出率与合格率

```{r shanghai-category-drug-table, results="asis", dev='png'}
sp_dable(shanghai_category_drug, ref_text = "(ref:shanghai-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:shanghai-category-drug) 给出了上海市的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shanghai-category-drug-det-eheatmap) - 图 \@ref(fig:shanghai-category-drug-def-eheatmap)。可以看出，上海市各蔬菜类别各农药的抽检样本量在 `r text_range(shanghai_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shanghai_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shanghai_category_drug, "qualification_rate_percent")` 之间。

```{r shanghai-category-drug-det-eheatmap, fig.cap="上海市各蔬菜类别各药物检出率热力图"}
heatmap(
  shanghai_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shanghai-category-drug-def-eheatmap, fig.cap="上海市各蔬菜类别各药物超标率热力图"}
heatmap(
  shanghai_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 四川省

```{r sichuan-category-drug}
sichuan_category_drug <- province_category_drug %>%
  filter(province == "四川省")
```

(ref:sichuan-category-drug) 四川省各蔬菜类别各农药检出率与合格率

```{r sichuan-category-drug-table, results="asis", dev='png'}
sp_dable(sichuan_category_drug, ref_text = "(ref:sichuan-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:sichuan-category-drug) 给出了四川省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:sichuan-category-drug-det-eheatmap) - 图 \@ref(fig:sichuan-category-drug-def-eheatmap)。可以看出，四川省各蔬菜类别各农药的抽检样本量在 `r text_range(sichuan_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(sichuan_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(sichuan_category_drug, "qualification_rate_percent")` 之间。

```{r sichuan-category-drug-det-eheatmap, fig.cap="四川省各蔬菜类别各药物检出率热力图"}
heatmap(
  sichuan_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r sichuan-category-drug-def-eheatmap, fig.cap="四川省各蔬菜类别各药物超标率热力图"}
heatmap(
  sichuan_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 天津市

```{r tianjin-category-drug}
tianjin_category_drug <- province_category_drug %>%
  filter(province == "天津市")
```

(ref:tianjin-category-drug) 天津市各蔬菜类别各农药检出率与合格率

```{r tianjin-category-drug-table, results="asis", dev='png'}
sp_dable(tianjin_category_drug, ref_text = "(ref:tianjin-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:tianjin-category-drug) 给出了天津市的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:tianjin-category-drug-det-eheatmap) - 图 \@ref(fig:tianjin-category-drug-def-eheatmap)。可以看出，天津市各蔬菜类别各农药的抽检样本量在 `r text_range(tianjin_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(tianjin_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(tianjin_category_drug, "qualification_rate_percent")` 之间。

```{r tianjin-category-drug-det-eheatmap, fig.cap="天津市各蔬菜类别各药物检出率热力图"}
heatmap(
  tianjin_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r tianjin-category-drug-def-eheatmap, fig.cap="天津市各蔬菜类别各药物超标率热力图"}
heatmap(
  tianjin_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 西藏自治区

```{r xizang-category-drug}
xizang_category_drug <- province_category_drug %>%
  filter(province == "西藏自治区")
```

(ref:xizang-category-drug) 西藏自治区各蔬菜类别各农药检出率与合格率

```{r xizang-category-drug-table, results="asis", dev='png'}
sp_dable(xizang_category_drug, ref_text = "(ref:xizang-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:xizang-category-drug) 给出了西藏自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:xizang-category-drug-det-eheatmap) - 图 \@ref(fig:xizang-category-drug-def-eheatmap)。可以看出，西藏自治区各蔬菜类别各农药的抽检样本量在 `r text_range(xizang_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(xizang_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(xizang_category_drug, "qualification_rate_percent")` 之间。

```{r xizang-category-drug-det-eheatmap, fig.cap="西藏自治区各蔬菜类别各药物检出率热力图"}
heatmap(
  xizang_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r xizang-category-drug-def-eheatmap, fig.cap="西藏自治区各蔬菜类别各药物超标率热力图"}
heatmap(
  xizang_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 新疆维吾尔自治区

```{r xinjiang-category-drug}
xinjiang_category_drug <- province_category_drug %>%
  filter(province == "新疆维吾尔自治区")
```

(ref:xinjiang-category-drug) 新疆维吾尔自治区各蔬菜类别各农药检出率与合格率

```{r xinjiang-category-drug-table, results="asis", dev='png'}
sp_dable(xinjiang_category_drug, ref_text = "(ref:xinjiang-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:xinjiang-category-drug) 给出了新疆维吾尔自治区的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:xinjiang-category-drug-det-eheatmap) - 图 \@ref(fig:xinjiang-category-drug-def-eheatmap)。可以看出，新疆维吾尔自治区各蔬菜类别各农药的抽检样本量在 `r text_range(xinjiang_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(xinjiang_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(xinjiang_category_drug, "qualification_rate_percent")` 之间。

```{r xinjiang-category-drug-det-eheatmap, fig.cap="新疆维吾尔自治区各蔬菜类别各药物检出率热力图"}
heatmap(
  xinjiang_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r xinjiang-category-drug-def-eheatmap, fig.cap="新疆维吾尔自治区各蔬菜类别各药物超标率热力图"}
heatmap(
  xinjiang_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 云南省

```{r yunnan-category-drug}
yunnan_category_drug <- province_category_drug %>%
  filter(province == "云南省")
```

(ref:yunnan-category-drug) 云南省各蔬菜类别各农药检出率与合格率

```{r yunnan-category-drug-table, results="asis", dev='png'}
sp_dable(yunnan_category_drug, ref_text = "(ref:yunnan-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:yunnan-category-drug) 给出了云南省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:yunnan-category-drug-det-eheatmap) - 图 \@ref(fig:yunnan-category-drug-def-eheatmap)。可以看出，云南省各蔬菜类别各农药的抽检样本量在 `r text_range(yunnan_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(yunnan_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(yunnan_category_drug, "qualification_rate_percent")` 之间。

```{r yunnan-category-drug-det-eheatmap, fig.cap="云南省各蔬菜类别各药物检出率热力图"}
heatmap(
  yunnan_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r yunnan-category-drug-def-eheatmap, fig.cap="云南省各蔬菜类别各药物超标率热力图"}
heatmap(
  yunnan_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 浙江省

```{r zhejiang-category-drug}
zhejiang_category_drug <- province_category_drug %>%
  filter(province == "浙江省")
```

(ref:zhejiang-category-drug) 浙江省各蔬菜类别各农药检出率与合格率

```{r zhejiang-category-drug-table, results="asis", dev='png'}
sp_dable(zhejiang_category_drug, ref_text = "(ref:zhejiang-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:zhejiang-category-drug) 给出了浙江省的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:zhejiang-category-drug-det-eheatmap) - 图 \@ref(fig:zhejiang-category-drug-def-eheatmap)。可以看出，浙江省各蔬菜类别各农药的抽检样本量在 `r text_range(zhejiang_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(zhejiang_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(zhejiang_category_drug, "qualification_rate_percent")` 之间。

```{r zhejiang-category-drug-det-eheatmap, fig.cap="浙江省各蔬菜类别各药物检出率热力图"}
heatmap(
  zhejiang_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r zhejiang-category-drug-def-eheatmap, fig.cap="浙江省各蔬菜类别各药物超标率热力图"}
heatmap(
  zhejiang_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 重庆市

```{r chongqing-category-drug}
chongqing_category_drug <- province_category_drug %>%
  filter(province == "重庆市")
```

(ref:chongqing-category-drug) 重庆市各蔬菜类别各农药检出率与合格率

```{r chongqing-category-drug-table, results="asis", dev='png'}
sp_dable(chongqing_category_drug, ref_text = "(ref:chongqing-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:chongqing-category-drug) 给出了重庆市的 `r nrow(category)` 种蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:chongqing-category-drug-det-eheatmap) - 图 \@ref(fig:chongqing-category-drug-def-eheatmap)。可以看出，重庆市各蔬菜类别各农药的抽检样本量在 `r text_range(chongqing_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(chongqing_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(chongqing_category_drug, "qualification_rate_percent")` 之间。

```{r chongqing-category-drug-det-eheatmap, fig.cap="重庆市各蔬菜类别各药物检出率热力图"}
heatmap(
  chongqing_category_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r chongqing-category-drug-def-eheatmap, fig.cap="重庆市各蔬菜类别各药物超标率热力图"}
heatmap(
  chongqing_category_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```


## “省份-品种-药品”残留风险

```{r province-product-drug}
province_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  province, product, drug
) %>%
  factor_dims(province, product, drug)
```

`r text_threshold(data = province_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("province", "product", "drug"))`

(ref:province-product-drug) 各省份各品种各农药检出率与合格率

```{r province-product-drug-table, results="asis", dev='png', eval=FALSE}
sp_dable(province_product_drug, ref_text = "(ref:province-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:anhui-product-drug) - 表 \@ref(tab:chongqing-product-drug) 给出了 `r nrow(province)` 个省市自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:anhui-product-drug-det-eheatmap) - 图 \@ref(fig:chongqing-product-drug-def-eheatmap)。可以看出，各省市自治区各蔬菜品种各农药的抽检样本量在 `r text_range(province_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(province_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(province_product_drug, "qualification_rate_percent")` 之间。

### 安徽省

```{r anhui-product-drug}
anhui_product_drug <- province_product_drug %>%
  filter(province == "安徽省")
```

(ref:anhui-product-drug) 安徽省各品种各农药检出率与合格率

```{r anhui-product-drug-table, results="asis", dev='png'}
sp_dable(anhui_product_drug, ref_text = "(ref:anhui-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:anhui-product-drug) 给出了安徽省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:anhui-product-drug-det-eheatmap) - 图 \@ref(fig:anhui-product-drug-def-eheatmap)。可以看出，安徽省各蔬菜品种各农药的抽检样本量在 `r text_range(anhui_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(anhui_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(anhui_product_drug, "qualification_rate_percent")` 之间。

```{r anhui-product-drug-det-eheatmap, fig.cap="安徽省各品种各药物检出率热力图"}
heatmap(
  anhui_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r anhui-product-drug-def-eheatmap, fig.cap="安徽省各品种各药物超标率热力图"}
heatmap(
  anhui_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 北京市

```{r beijing-product-drug}
beijing_product_drug <- province_product_drug %>%
  filter(province == "北京市")
```

(ref:beijing-product-drug) 北京市各品种各农药检出率与合格率

```{r beijing-product-drug-table, results="asis", dev='png'}
sp_dable(beijing_product_drug, ref_text = "(ref:beijing-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:beijing-product-drug) 给出了北京市的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:beijing-product-drug-det-eheatmap) - 图 \@ref(fig:beijing-product-drug-def-eheatmap)。可以看出，北京市各蔬菜品种各农药的抽检样本量在 `r text_range(beijing_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(beijing_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(beijing_product_drug, "qualification_rate_percent")` 之间。

```{r beijing-product-drug-det-eheatmap, fig.cap="北京市各品种各药物检出率热力图"}
heatmap(
  beijing_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r beijing-product-drug-def-eheatmap, fig.cap="北京市各品种各药物超标率热力图"}
heatmap(
  beijing_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 福建省

```{r fujian-product-drug}
fujian_product_drug <- province_product_drug %>%
  filter(province == "福建省")
```

(ref:fujian-product-drug) 福建省各品种各农药检出率与合格率

```{r fujian-product-drug-table, results="asis", dev='png'}
sp_dable(fujian_product_drug, ref_text = "(ref:fujian-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:fujian-product-drug) 给出了福建省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:fujian-product-drug-det-eheatmap) - 图 \@ref(fig:fujian-product-drug-def-eheatmap)。可以看出，福建省各蔬菜品种各农药的抽检样本量在 `r text_range(fujian_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(fujian_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(fujian_product_drug, "qualification_rate_percent")` 之间。

```{r fujian-product-drug-det-eheatmap, fig.cap="福建省各品种各药物检出率热力图"}
heatmap(
  fujian_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r fujian-product-drug-def-eheatmap, fig.cap="福建省各品种各药物超标率热力图"}
heatmap(
  fujian_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 甘肃省

```{r gansu-product-drug}
gansu_product_drug <- province_product_drug %>%
  filter(province == "甘肃省")
```

(ref:gansu-product-drug) 甘肃省各品种各农药检出率与合格率

```{r gansu-product-drug-table, results="asis", dev='png'}
sp_dable(gansu_product_drug, ref_text = "(ref:gansu-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:gansu-product-drug) 给出了甘肃省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:gansu-product-drug-det-eheatmap) - 图 \@ref(fig:gansu-product-drug-def-eheatmap)。可以看出，甘肃省各蔬菜品种各农药的抽检样本量在 `r text_range(gansu_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(gansu_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(gansu_product_drug, "qualification_rate_percent")` 之间。

```{r gansu-product-drug-det-eheatmap, fig.cap="甘肃省各品种各药物检出率热力图"}
heatmap(
  gansu_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r gansu-product-drug-def-eheatmap, fig.cap="甘肃省各品种各药物超标率热力图"}
heatmap(
  gansu_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 广东省

```{r guangdong-product-drug}
guangdong_product_drug <- province_product_drug %>%
  filter(province == "广东省")
```

(ref:guangdong-product-drug) 广东省各品种各农药检出率与合格率

```{r guangdong-product-drug-table, results="asis", dev='png'}
sp_dable(guangdong_product_drug, ref_text = "(ref:guangdong-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:guangdong-product-drug) 给出了广东省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guangdong-product-drug-det-eheatmap) - 图 \@ref(fig:guangdong-product-drug-def-eheatmap)。可以看出，广东省各蔬菜品种各农药的抽检样本量在 `r text_range(guangdong_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guangdong_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guangdong_product_drug, "qualification_rate_percent")` 之间。

```{r guangdong-product-drug-det-eheatmap, fig.cap="广东省各品种各药物检出率热力图"}
heatmap(
  guangdong_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guangdong-product-drug-def-eheatmap, fig.cap="广东省各品种各药物超标率热力图"}
heatmap(
  guangdong_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 广西壮族自治区

```{r guangxi-product-drug}
guangxi_product_drug <- province_product_drug %>%
  filter(province == "广西壮族自治区")
```

(ref:guangxi-product-drug) 广西壮族自治区各品种各农药检出率与合格率

```{r guangxi-product-drug-table, results="asis", dev='png'}
sp_dable(guangxi_product_drug, ref_text = "(ref:guangxi-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:guangxi-product-drug) 给出了广西壮族自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guangxi-product-drug-det-eheatmap) - 图 \@ref(fig:guangxi-product-drug-def-eheatmap)。可以看出，广西壮族自治区各蔬菜品种各农药的抽检样本量在 `r text_range(guangxi_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guangxi_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guangxi_product_drug, "qualification_rate_percent")` 之间。

```{r guangxi-product-drug-det-eheatmap, fig.cap="广西壮族自治区各品种各药物检出率热力图"}
heatmap(
  guangxi_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guangxi-product-drug-def-eheatmap, fig.cap="广西壮族自治区各品种各药物超标率热力图"}
heatmap(
  guangxi_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 贵州省

```{r guizhou-product-drug}
guizhou_product_drug <- province_product_drug %>%
  filter(province == "贵州省")
```

(ref:guizhou-product-drug) 贵州省各品种各农药检出率与合格率

```{r guizhou-product-drug-table, results="asis", dev='png'}
sp_dable(guizhou_product_drug, ref_text = "(ref:guizhou-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:guizhou-product-drug) 给出了贵州省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:guizhou-product-drug-det-eheatmap) - 图 \@ref(fig:guizhou-product-drug-def-eheatmap)。可以看出，贵州省各蔬菜品种各农药的抽检样本量在 `r text_range(guizhou_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(guizhou_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(guizhou_product_drug, "qualification_rate_percent")` 之间。

```{r guizhou-product-drug-det-eheatmap, fig.cap="贵州省各品种各药物检出率热力图"}
heatmap(
  guizhou_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r guizhou-product-drug-def-eheatmap, fig.cap="贵州省各品种各药物超标率热力图"}
heatmap(
  guizhou_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 海南省

```{r hainan-product-drug}
hainan_product_drug <- province_product_drug %>%
  filter(province == "海南省")
```

(ref:hainan-product-drug) 海南省各品种各农药检出率与合格率

```{r hainan-product-drug-table, results="asis", dev='png'}
sp_dable(hainan_product_drug, ref_text = "(ref:hainan-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:hainan-product-drug) 给出了海南省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hainan-product-drug-det-eheatmap) - 图 \@ref(fig:hainan-product-drug-def-eheatmap)。可以看出，海南省各蔬菜品种各农药的抽检样本量在 `r text_range(hainan_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hainan_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hainan_product_drug, "qualification_rate_percent")` 之间。

```{r hainan-product-drug-det-eheatmap, fig.cap="海南省各品种各药物检出率热力图"}
heatmap(
  hainan_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hainan-product-drug-def-eheatmap, fig.cap="海南省各品种各药物超标率热力图"}
heatmap(
  hainan_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 河北省

```{r hebei-product-drug}
hebei_product_drug <- province_product_drug %>%
  filter(province == "河北省")
```

(ref:hebei-product-drug) 河北省各品种各农药检出率与合格率

```{r hebei-product-drug-table, results="asis", dev='png'}
sp_dable(hebei_product_drug, ref_text = "(ref:hebei-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:hebei-product-drug) 给出了河北省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hebei-product-drug-det-eheatmap) - 图 \@ref(fig:hebei-product-drug-def-eheatmap)。可以看出，河北省各蔬菜品种各农药的抽检样本量在 `r text_range(hebei_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hebei_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hebei_product_drug, "qualification_rate_percent")` 之间。

```{r hebei-product-drug-det-eheatmap, fig.cap="河北省各品种各药物检出率热力图"}
heatmap(
  hebei_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hebei-product-drug-def-eheatmap, fig.cap="河北省各品种各药物超标率热力图"}
heatmap(
  hebei_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 河南省

```{r henan-product-drug}
henan_product_drug <- province_product_drug %>%
  filter(province == "河南省")
```

(ref:henan-product-drug) 河南省各品种各农药检出率与合格率

```{r henan-product-drug-table, results="asis", dev='png'}
sp_dable(henan_product_drug, ref_text = "(ref:henan-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:henan-product-drug) 给出了河南省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:henan-product-drug-det-eheatmap) - 图 \@ref(fig:henan-product-drug-def-eheatmap)。可以看出，河南省各蔬菜品种各农药的抽检样本量在 `r text_range(henan_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(henan_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(henan_product_drug, "qualification_rate_percent")` 之间。

```{r henan-product-drug-det-eheatmap, fig.cap="河南省各品种各药物检出率热力图"}
heatmap(
  henan_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r henan-product-drug-def-eheatmap, fig.cap="河南省各品种各药物超标率热力图"}
heatmap(
  henan_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 黑龙江省

```{r heilongjiang-product-drug}
heilongjiang_product_drug <- province_product_drug %>%
  filter(province == "黑龙江省")
```

(ref:heilongjiang-product-drug) 黑龙江省各品种各农药检出率与合格率

```{r heilongjiang-product-drug-table, results="asis", dev='png'}
sp_dable(heilongjiang_product_drug, ref_text = "(ref:heilongjiang-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:heilongjiang-product-drug) 给出了黑龙江省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:heilongjiang-product-drug-det-eheatmap) - 图 \@ref(fig:heilongjiang-product-drug-def-eheatmap)。可以看出，黑龙江省各蔬菜品种各农药的抽检样本量在 `r text_range(heilongjiang_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(heilongjiang_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(heilongjiang_product_drug, "qualification_rate_percent")` 之间。

```{r heilongjiang-product-drug-det-eheatmap, fig.cap="黑龙江省各品种各药物检出率热力图"}
heatmap(
  heilongjiang_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r heilongjiang-product-drug-def-eheatmap, fig.cap="黑龙江省各品种各药物超标率热力图"}
heatmap(
  heilongjiang_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 湖北省

```{r hubei-product-drug}
hubei_product_drug <- province_product_drug %>%
  filter(province == "湖北省")
```

(ref:hubei-product-drug) 湖北省各品种各农药检出率与合格率

```{r hubei-product-drug-table, results="asis", dev='png'}
sp_dable(hubei_product_drug, ref_text = "(ref:hubei-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:hubei-product-drug) 给出了湖北省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hubei-product-drug-det-eheatmap) - 图 \@ref(fig:hubei-product-drug-def-eheatmap)。可以看出，湖北省各蔬菜品种各农药的抽检样本量在 `r text_range(hubei_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hubei_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hubei_product_drug, "qualification_rate_percent")` 之间。

```{r hubei-product-drug-det-eheatmap, fig.cap="湖北省各品种各药物检出率热力图"}
heatmap(
  hubei_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hubei-product-drug-def-eheatmap, fig.cap="湖北省各品种各药物超标率热力图"}
heatmap(
  hubei_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 湖南省

```{r hunan-product-drug}
hunan_product_drug <- province_product_drug %>%
  filter(province == "湖南省")
```

(ref:hunan-product-drug) 湖南省各品种各农药检出率与合格率

```{r hunan-product-drug-table, results="asis", dev='png'}
sp_dable(hunan_product_drug, ref_text = "(ref:hunan-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:hunan-product-drug) 给出了湖南省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:hunan-product-drug-det-eheatmap) - 图 \@ref(fig:hunan-product-drug-def-eheatmap)。可以看出，湖南省各蔬菜品种各农药的抽检样本量在 `r text_range(hunan_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(hunan_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(hunan_product_drug, "qualification_rate_percent")` 之间。

```{r hunan-product-drug-det-eheatmap, fig.cap="湖南省各品种各药物检出率热力图"}
heatmap(
  hunan_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r hunan-product-drug-def-eheatmap, fig.cap="湖南省各品种各药物超标率热力图"}
heatmap(
  hunan_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 吉林省

```{r jiling-product-drug}
jiling_product_drug <- province_product_drug %>%
  filter(province == "吉林省")
```

(ref:jiling-product-drug) 吉林省各品种各农药检出率与合格率

```{r jiling-product-drug-table, results="asis", dev='png'}
sp_dable(jiling_product_drug, ref_text = "(ref:jiling-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiling-product-drug) 给出了吉林省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiling-product-drug-det-eheatmap) - 图 \@ref(fig:jiling-product-drug-def-eheatmap)。可以看出，吉林省各蔬菜品种各农药的抽检样本量在 `r text_range(jiling_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiling_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiling_product_drug, "qualification_rate_percent")` 之间。

```{r jiling-product-drug-det-eheatmap, fig.cap="吉林省各品种各药物检出率热力图"}
heatmap(
  jiling_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiling-product-drug-def-eheatmap, fig.cap="吉林省各品种各药物超标率热力图"}
heatmap(
  jiling_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 江苏省

```{r jiangsu-product-drug}
jiangsu_product_drug <- province_product_drug %>%
  filter(province == "江苏省")
```

(ref:jiangsu-product-drug) 江苏省各品种各农药检出率与合格率

```{r jiangsu-product-drug-table, results="asis", dev='png'}
sp_dable(jiangsu_product_drug, ref_text = "(ref:jiangsu-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiangsu-product-drug) 给出了江苏省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiangsu-product-drug-det-eheatmap) - 图 \@ref(fig:jiangsu-product-drug-def-eheatmap)。可以看出，江苏省各蔬菜品种各农药的抽检样本量在 `r text_range(jiangsu_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiangsu_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiangsu_product_drug, "qualification_rate_percent")` 之间。

```{r jiangsu-product-drug-det-eheatmap, fig.cap="江苏省各品种各药物检出率热力图"}
heatmap(
  jiangsu_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiangsu-product-drug-def-eheatmap, fig.cap="江苏省各品种各药物超标率热力图"}
heatmap(
  jiangsu_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 江西省

```{r jiangxi-product-drug}
jiangxi_product_drug <- province_product_drug %>%
  filter(province == "江西省")
```

(ref:jiangxi-product-drug) 江西省各品种各农药检出率与合格率

```{r jiangxi-product-drug-table, results="asis", dev='png'}
sp_dable(jiangxi_product_drug, ref_text = "(ref:jiangxi-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:jiangxi-product-drug) 给出了江西省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:jiangxi-product-drug-det-eheatmap) - 图 \@ref(fig:jiangxi-product-drug-def-eheatmap)。可以看出，江西省各蔬菜品种各农药的抽检样本量在 `r text_range(jiangxi_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(jiangxi_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(jiangxi_product_drug, "qualification_rate_percent")` 之间。

```{r jiangxi-product-drug-det-eheatmap, fig.cap="江西省各品种各药物检出率热力图"}
heatmap(
  jiangxi_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r jiangxi-product-drug-def-eheatmap, fig.cap="江西省各品种各药物超标率热力图"}
heatmap(
  jiangxi_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 辽宁省

```{r liaoning-product-drug}
liaoning_product_drug <- province_product_drug %>%
  filter(province == "辽宁省")
```

(ref:liaoning-product-drug) 辽宁省各品种各农药检出率与合格率

```{r liaoning-product-drug-table, results="asis", dev='png'}
sp_dable(liaoning_product_drug, ref_text = "(ref:liaoning-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:liaoning-product-drug) 给出了辽宁省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:liaoning-product-drug-det-eheatmap) - 图 \@ref(fig:liaoning-product-drug-def-eheatmap)。可以看出，辽宁省各蔬菜品种各农药的抽检样本量在 `r text_range(liaoning_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(liaoning_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(liaoning_product_drug, "qualification_rate_percent")` 之间。

```{r liaoning-product-drug-det-eheatmap, fig.cap="辽宁省各品种各药物检出率热力图"}
heatmap(
  liaoning_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r liaoning-product-drug-def-eheatmap, fig.cap="辽宁省各品种各药物超标率热力图"}
heatmap(
  liaoning_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 内蒙古自治区

```{r neimenggu-product-drug}
neimenggu_product_drug <- province_product_drug %>%
  filter(province == "内蒙古自治区")
```

(ref:neimenggu-product-drug) 内蒙古自治区各品种各农药检出率与合格率

```{r neimenggu-product-drug-table, results="asis", dev='png'}
sp_dable(neimenggu_product_drug, ref_text = "(ref:neimenggu-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:neimenggu-product-drug) 给出了内蒙古自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:neimenggu-product-drug-det-eheatmap) - 图 \@ref(fig:neimenggu-product-drug-def-eheatmap)。可以看出，内蒙古自治区各蔬菜品种各农药的抽检样本量在 `r text_range(neimenggu_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(neimenggu_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(neimenggu_product_drug, "qualification_rate_percent")` 之间。

```{r neimenggu-product-drug-det-eheatmap, fig.cap="内蒙古自治区各品种各药物检出率热力图"}
heatmap(
  neimenggu_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r neimenggu-product-drug-def-eheatmap, fig.cap="内蒙古自治区各品种各药物超标率热力图"}
heatmap(
  neimenggu_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 宁夏回族自治区

```{r ningxia-product-drug}
ningxia_product_drug <- province_product_drug %>%
  filter(province == "宁夏回族自治区")
```

(ref:ningxia-product-drug) 宁夏回族自治区各品种各农药检出率与合格率

```{r ningxia-product-drug-table, results="asis", dev='png'}
sp_dable(ningxia_product_drug, ref_text = "(ref:ningxia-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:ningxia-product-drug) 给出了宁夏回族自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:ningxia-product-drug-det-eheatmap) - 图 \@ref(fig:ningxia-product-drug-def-eheatmap)。可以看出，宁夏回族自治区各蔬菜品种各农药的抽检样本量在 `r text_range(ningxia_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(ningxia_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(ningxia_product_drug, "qualification_rate_percent")` 之间。

```{r ningxia-product-drug-det-eheatmap, fig.cap="宁夏回族自治区各品种各药物检出率热力图"}
heatmap(
  ningxia_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r ningxia-product-drug-def-eheatmap, fig.cap="宁夏回族自治区各品种各药物超标率热力图"}
heatmap(
  ningxia_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 青海省

```{r qinghai-product-drug}
qinghai_product_drug <- province_product_drug %>%
  filter(province == "青海省")
```

(ref:qinghai-product-drug) 青海省各品种各农药检出率与合格率

```{r qinghai-product-drug-table, results="asis", dev='png'}
sp_dable(qinghai_product_drug, ref_text = "(ref:qinghai-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:qinghai-product-drug) 给出了青海省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:qinghai-product-drug-det-eheatmap) - 图 \@ref(fig:qinghai-product-drug-def-eheatmap)。可以看出，青海省各蔬菜品种各农药的抽检样本量在 `r text_range(qinghai_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(qinghai_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(qinghai_product_drug, "qualification_rate_percent")` 之间。

```{r qinghai-product-drug-det-eheatmap, fig.cap="青海省各品种各药物检出率热力图"}
heatmap(
  qinghai_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r qinghai-product-drug-def-eheatmap, fig.cap="青海省各品种各药物超标率热力图"}
heatmap(
  qinghai_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 山东省

```{r shandong-product-drug}
shandong_product_drug <- province_product_drug %>%
  filter(province == "山东省")
```

(ref:shandong-product-drug) 山东省各品种各农药检出率与合格率

```{r shandong-product-drug-table, results="asis", dev='png'}
sp_dable(shandong_product_drug, ref_text = "(ref:shandong-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:shandong-product-drug) 给出了山东省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shandong-product-drug-det-eheatmap) - 图 \@ref(fig:shandong-product-drug-def-eheatmap)。可以看出，山东省各蔬菜品种各农药的抽检样本量在 `r text_range(shandong_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shandong_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shandong_product_drug, "qualification_rate_percent")` 之间。

```{r shandong-product-drug-det-eheatmap, fig.cap="山东省各品种各药物检出率热力图"}
heatmap(
  shandong_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shandong-product-drug-def-eheatmap, fig.cap="山东省各品种各药物超标率热力图"}
heatmap(
  shandong_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 山西省

```{r shan1xi-product-drug}
shan1xi_product_drug <- province_product_drug %>%
  filter(province == "山西省")
```

(ref:shan1xi-product-drug) 山西省各品种各农药检出率与合格率

```{r shan1xi-product-drug-table, results="asis", dev='png'}
sp_dable(shan1xi_product_drug, ref_text = "(ref:shan1xi-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:shan1xi-product-drug) 给出了山西省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shan1xi-product-drug-det-eheatmap) - 图 \@ref(fig:shan1xi-product-drug-def-eheatmap)。可以看出，山西省各蔬菜品种各农药的抽检样本量在 `r text_range(shan1xi_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shan1xi_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shan1xi_product_drug, "qualification_rate_percent")` 之间。

```{r shan1xi-product-drug-det-eheatmap, fig.cap="山西省各品种各药物检出率热力图"}
heatmap(
  shan1xi_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shan1xi-product-drug-def-eheatmap, fig.cap="山西省各品种各药物超标率热力图"}
heatmap(
  shan1xi_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 陕西省

```{r shan3xi-product-drug}
shan3xi_product_drug <- province_product_drug %>%
  filter(province == "陕西省")
```

(ref:shan3xi-product-drug) 陕西省各品种各农药检出率与合格率

```{r shan3xi-product-drug-table, results="asis", dev='png'}
sp_dable(shan3xi_product_drug, ref_text = "(ref:shan3xi-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:shan3xi-product-drug) 给出了陕西省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shan3xi-product-drug-det-eheatmap) - 图 \@ref(fig:shan3xi-product-drug-def-eheatmap)。可以看出，陕西省各蔬菜品种各农药的抽检样本量在 `r text_range(shan3xi_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shan3xi_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shan3xi_product_drug, "qualification_rate_percent")` 之间。

```{r shan3xi-product-drug-det-eheatmap, fig.cap="陕西省各品种各药物检出率热力图"}
heatmap(
  shan3xi_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shan3xi-product-drug-def-eheatmap, fig.cap="陕西省各品种各药物超标率热力图"}
heatmap(
  shan3xi_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 上海市

```{r shanghai-product-drug}
shanghai_product_drug <- province_product_drug %>%
  filter(province == "上海市")
```

(ref:shanghai-product-drug) 上海市各品种各农药检出率与合格率

```{r shanghai-product-drug-table, results="asis", dev='png'}
sp_dable(shanghai_product_drug, ref_text = "(ref:shanghai-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:shanghai-product-drug) 给出了上海市的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:shanghai-product-drug-det-eheatmap) - 图 \@ref(fig:shanghai-product-drug-def-eheatmap)。可以看出，上海市各蔬菜品种各农药的抽检样本量在 `r text_range(shanghai_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(shanghai_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(shanghai_product_drug, "qualification_rate_percent")` 之间。

```{r shanghai-product-drug-det-eheatmap, fig.cap="上海市各品种各药物检出率热力图"}
heatmap(
  shanghai_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r shanghai-product-drug-def-eheatmap, fig.cap="上海市各品种各药物超标率热力图"}
heatmap(
  shanghai_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 四川省

```{r sichuan-product-drug}
sichuan_product_drug <- province_product_drug %>%
  filter(province == "四川省")
```

(ref:sichuan-product-drug) 四川省各品种各农药检出率与合格率

```{r sichuan-product-drug-table, results="asis", dev='png'}
sp_dable(sichuan_product_drug, ref_text = "(ref:sichuan-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:sichuan-product-drug) 给出了四川省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:sichuan-product-drug-det-eheatmap) - 图 \@ref(fig:sichuan-product-drug-def-eheatmap)。可以看出，四川省各蔬菜品种各农药的抽检样本量在 `r text_range(sichuan_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(sichuan_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(sichuan_product_drug, "qualification_rate_percent")` 之间。

```{r sichuan-product-drug-det-eheatmap, fig.cap="四川省各品种各药物检出率热力图"}
heatmap(
  sichuan_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r sichuan-product-drug-def-eheatmap, fig.cap="四川省各品种各药物超标率热力图"}
heatmap(
  sichuan_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 天津市

```{r tianjin-product-drug}
tianjin_product_drug <- province_product_drug %>%
  filter(province == "天津市")
```

(ref:tianjin-product-drug) 天津市各品种各农药检出率与合格率

```{r tianjin-product-drug-table, results="asis", dev='png'}
sp_dable(tianjin_product_drug, ref_text = "(ref:tianjin-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:tianjin-product-drug) 给出了天津市的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:tianjin-product-drug-det-eheatmap) - 图 \@ref(fig:tianjin-product-drug-def-eheatmap)。可以看出，天津市各蔬菜品种各农药的抽检样本量在 `r text_range(tianjin_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(tianjin_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(tianjin_product_drug, "qualification_rate_percent")` 之间。

```{r tianjin-product-drug-det-eheatmap, fig.cap="天津市各品种各药物检出率热力图"}
heatmap(
  tianjin_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r tianjin-product-drug-def-eheatmap, fig.cap="天津市各品种各药物超标率热力图"}
heatmap(
  tianjin_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 西藏自治区

```{r xizang-product-drug}
xizang_product_drug <- province_product_drug %>%
  filter(province == "西藏自治区")
```

(ref:xizang-product-drug) 西藏自治区各品种各农药检出率与合格率

```{r xizang-product-drug-table, results="asis", dev='png'}
sp_dable(xizang_product_drug, ref_text = "(ref:xizang-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:xizang-product-drug) 给出了西藏自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:xizang-product-drug-det-eheatmap) - 图 \@ref(fig:xizang-product-drug-def-eheatmap)。可以看出，西藏自治区各蔬菜品种各农药的抽检样本量在 `r text_range(xizang_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(xizang_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(xizang_product_drug, "qualification_rate_percent")` 之间。

```{r xizang-product-drug-det-eheatmap, fig.cap="西藏自治区各品种各药物检出率热力图"}
heatmap(
  xizang_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r xizang-product-drug-def-eheatmap, fig.cap="西藏自治区各品种各药物超标率热力图"}
heatmap(
  xizang_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 新疆维吾尔自治区

```{r xinjiang-product-drug}
xinjiang_product_drug <- province_product_drug %>%
  filter(province == "新疆维吾尔自治区")
```

(ref:xinjiang-product-drug) 新疆维吾尔自治区各品种各农药检出率与合格率

```{r xinjiang-product-drug-table, results="asis", dev='png'}
sp_dable(xinjiang_product_drug, ref_text = "(ref:xinjiang-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:xinjiang-product-drug) 给出了新疆维吾尔自治区的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:xinjiang-product-drug-det-eheatmap) - 图 \@ref(fig:xinjiang-product-drug-def-eheatmap)。可以看出，新疆维吾尔自治区各蔬菜品种各农药的抽检样本量在 `r text_range(xinjiang_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(xinjiang_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(xinjiang_product_drug, "qualification_rate_percent")` 之间。

```{r xinjiang-product-drug-det-eheatmap, fig.cap="新疆维吾尔自治区各品种各药物检出率热力图"}
heatmap(
  xinjiang_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r xinjiang-product-drug-def-eheatmap, fig.cap="新疆维吾尔自治区各品种各药物超标率热力图"}
heatmap(
  xinjiang_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 云南省

```{r yunnan-product-drug}
yunnan_product_drug <- province_product_drug %>%
  filter(province == "云南省")
```

(ref:yunnan-product-drug) 云南省各品种各农药检出率与合格率

```{r yunnan-product-drug-table, results="asis", dev='png'}
sp_dable(yunnan_product_drug, ref_text = "(ref:yunnan-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:yunnan-product-drug) 给出了云南省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:yunnan-product-drug-det-eheatmap) - 图 \@ref(fig:yunnan-product-drug-def-eheatmap)。可以看出，云南省各蔬菜品种各农药的抽检样本量在 `r text_range(yunnan_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(yunnan_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(yunnan_product_drug, "qualification_rate_percent")` 之间。

```{r yunnan-product-drug-det-eheatmap, fig.cap="云南省各品种各药物检出率热力图"}
heatmap(
  yunnan_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r yunnan-product-drug-def-eheatmap, fig.cap="云南省各品种各药物超标率热力图"}
heatmap(
  yunnan_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 浙江省

```{r zhejiang-product-drug}
zhejiang_product_drug <- province_product_drug %>%
  filter(province == "浙江省")
```

(ref:zhejiang-product-drug) 浙江省各品种各农药检出率与合格率

```{r zhejiang-product-drug-table, results="asis", dev='png'}
sp_dable(zhejiang_product_drug, ref_text = "(ref:zhejiang-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:zhejiang-product-drug) 给出了浙江省的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:zhejiang-product-drug-det-eheatmap) - 图 \@ref(fig:zhejiang-product-drug-def-eheatmap)。可以看出，浙江省各蔬菜品种各农药的抽检样本量在 `r text_range(zhejiang_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(zhejiang_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(zhejiang_product_drug, "qualification_rate_percent")` 之间。

```{r zhejiang-product-drug-det-eheatmap, fig.cap="浙江省各品种各药物检出率热力图"}
heatmap(
  zhejiang_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r zhejiang-product-drug-def-eheatmap, fig.cap="浙江省各品种各药物超标率热力图"}
heatmap(
  zhejiang_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 重庆市

```{r chongqing-product-drug}
chongqing_product_drug <- province_product_drug %>%
  filter(province == "重庆市")
```

(ref:chongqing-product-drug) 重庆市各品种各农药检出率与合格率

```{r chongqing-product-drug-table, results="asis", dev='png'}
sp_dable(chongqing_product_drug, ref_text = "(ref:chongqing-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:chongqing-product-drug) 给出了重庆市的 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:chongqing-product-drug-det-eheatmap) - 图 \@ref(fig:chongqing-product-drug-def-eheatmap)。可以看出，重庆市各蔬菜品种各农药的抽检样本量在 `r text_range(chongqing_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(chongqing_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(chongqing_product_drug, "qualification_rate_percent")` 之间。

```{r chongqing-product-drug-det-eheatmap, fig.cap="重庆市各品种各药物检出率热力图"}
heatmap(
  chongqing_product_drug %>% shorten_province_name(), 
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r chongqing-product-drug-def-eheatmap, fig.cap="重庆市各品种各药物超标率热力图"}
heatmap(
  chongqing_product_drug %>% change_to_defective() %>% shorten_province_name(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

## “年份-季度-省份-药品”残留风险

```{r year-quarter-province-drug, cache=!params$product_env}
year_quarter_province_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, province, drug
)
```

`r text_threshold(data = year_quarter_province_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "province", "drug"))`

(ref:year-quarter-province-drug) 各年份各季度各省份各农药检出率与合格率

```{r year-quarter-province-drug-table, results="asis", dev='png', eval=FALSE}
sp_dable(
  year_quarter_province_drug %>%
    factor_dims(year, quarter, province, drug), 
  ref_text = "(ref:year-quarter-province-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-anhui-drug) - 表 \@ref(tab:year-quarter-chongqing-drug) 给出了 `r year_range[1]` 年第一季度 `r year_range[2]` 年第四季度 `r nrow(province)` 个省市自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各年份各季度各省市自治区各农药的抽检样本量在 `r text_range(year_quarter_province_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_province_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_province_drug, "qualification_rate_percent")` 之间。

### 安徽省

```{r year-quarter-anhui-drug}
year_quarter_anhui_drug <- year_quarter_province_drug %>%
  filter(province == "安徽省")
```

(ref:year-quarter-anhui-drug) 安徽省各年份各季度各农药检出率与合格率

```{r year-quarter-anhui-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_anhui_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-anhui-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-anhui-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度安徽省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-anhui-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-anhui-drug-def-eheatmap)。可以看出，安徽省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_anhui_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_anhui_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_anhui_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-anhui-drug-det-eheatmap, fig.cap="安徽省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_anhui_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-anhui-drug-def-eheatmap, fig.cap="安徽省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_anhui_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 北京市

```{r year-quarter-beijing-drug}
year_quarter_beijing_drug <- year_quarter_province_drug %>%
  filter(province == "北京市")
```

(ref:year-quarter-beijing-drug) 北京市各年份各季度各农药检出率与合格率

```{r year-quarter-beijing-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_beijing_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-beijing-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-beijing-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度北京市在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-beijing-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-beijing-drug-def-eheatmap)。可以看出，北京市各年各季度各农药的抽检样本量在 `r text_range(year_quarter_beijing_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_beijing_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_beijing_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-beijing-drug-det-eheatmap, fig.cap="北京市各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_beijing_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-beijing-drug-def-eheatmap, fig.cap="北京市各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_beijing_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 福建省

```{r year-quarter-fujian-drug}
year_quarter_fujian_drug <- year_quarter_province_drug %>%
  filter(province == "福建省")
```

(ref:year-quarter-fujian-drug) 福建省各年份各季度各农药检出率与合格率

```{r year-quarter-fujian-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_fujian_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-fujian-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-fujian-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度福建省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-fujian-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-fujian-drug-def-eheatmap)。可以看出，福建省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_fujian_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_fujian_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_fujian_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-fujian-drug-det-eheatmap, fig.cap="福建省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_fujian_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-fujian-drug-def-eheatmap, fig.cap="福建省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_fujian_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 甘肃省

```{r year-quarter-gansu-drug}
year_quarter_gansu_drug <- year_quarter_province_drug %>%
  filter(province == "甘肃省")
```

(ref:year-quarter-gansu-drug) 甘肃省各年份各季度各农药检出率与合格率

```{r year-quarter-gansu-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_gansu_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-gansu-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-gansu-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度甘肃省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-gansu-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-gansu-drug-def-eheatmap)。可以看出，甘肃省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_gansu_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_gansu_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_gansu_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-gansu-drug-det-eheatmap, fig.cap="甘肃省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_gansu_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-gansu-drug-def-eheatmap, fig.cap="甘肃省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_gansu_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 广东省

```{r year-quarter-guangdong-drug}
year_quarter_guangdong_drug <- year_quarter_province_drug %>%
  filter(province == "广东省")
```

(ref:year-quarter-guangdong-drug) 广东省各年份各季度各农药检出率与合格率

```{r year-quarter-guangdong-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_guangdong_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-guangdong-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-guangdong-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度广东省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-guangdong-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-guangdong-drug-def-eheatmap)。可以看出，广东省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_guangdong_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_guangdong_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_guangdong_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-guangdong-drug-det-eheatmap, fig.cap="广东省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_guangdong_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-guangdong-drug-def-eheatmap, fig.cap="广东省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_guangdong_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 广西壮族自治区

```{r year-quarter-guangxi-drug}
year_quarter_guangxi_drug <- year_quarter_province_drug %>%
  filter(province == "广西壮族自治区")
```

(ref:year-quarter-guangxi-drug) 广西壮族自治区各年份各季度各农药检出率与合格率

```{r year-quarter-guangxi-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_guangxi_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-guangxi-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-guangxi-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度广西壮族自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-guangxi-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-guangxi-drug-def-eheatmap)。可以看出，广西壮族自治区各年各季度各农药的抽检样本量在 `r text_range(year_quarter_guangxi_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_guangxi_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_guangxi_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-guangxi-drug-det-eheatmap, fig.cap="广西壮族自治区各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_guangxi_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-guangxi-drug-def-eheatmap, fig.cap="广西壮族自治区各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_guangxi_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 贵州省

```{r year-quarter-guizhou-drug}
year_quarter_guizhou_drug <- year_quarter_province_drug %>%
  filter(province == "贵州省")
```

(ref:year-quarter-guizhou-drug) 贵州省各年份各季度各农药检出率与合格率

```{r year-quarter-guizhou-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_guizhou_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-guizhou-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-guizhou-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度贵州省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-guizhou-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-guizhou-drug-def-eheatmap)。可以看出，贵州省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_guizhou_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_guizhou_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_guizhou_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-guizhou-drug-det-eheatmap, fig.cap="贵州省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_guizhou_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-guizhou-drug-def-eheatmap, fig.cap="贵州省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_guizhou_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 海南省

```{r year-quarter-hainan-drug}
year_quarter_hainan_drug <- year_quarter_province_drug %>%
  filter(province == "海南省")
```

(ref:year-quarter-hainan-drug) 海南省各年份各季度各农药检出率与合格率

```{r year-quarter-hainan-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_hainan_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-hainan-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-hainan-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度海南省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-hainan-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-hainan-drug-def-eheatmap)。可以看出，海南省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_hainan_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_hainan_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_hainan_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-hainan-drug-det-eheatmap, fig.cap="海南省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_hainan_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-hainan-drug-def-eheatmap, fig.cap="海南省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_hainan_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 河北省

```{r year-quarter-hebei-drug}
year_quarter_hebei_drug <- year_quarter_province_drug %>%
  filter(province == "河北省")
```

(ref:year-quarter-hebei-drug) 河北省各年份各季度各农药检出率与合格率

```{r year-quarter-hebei-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_hebei_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-hebei-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-hebei-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度河北省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-hebei-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-hebei-drug-def-eheatmap)。可以看出，河北省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_hebei_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_hebei_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_hebei_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-hebei-drug-det-eheatmap, fig.cap="河北省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_hebei_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-hebei-drug-def-eheatmap, fig.cap="河北省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_hebei_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 河南省

```{r year-quarter-henan-drug}
year_quarter_henan_drug <- year_quarter_province_drug %>%
  filter(province == "河南省")
```

(ref:year-quarter-henan-drug) 河南省各年份各季度各农药检出率与合格率

```{r year-quarter-henan-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_henan_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-henan-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-henan-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度河南省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-henan-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-henan-drug-def-eheatmap)。可以看出，河南省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_henan_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_henan_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_henan_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-henan-drug-det-eheatmap, fig.cap="河南省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_henan_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-henan-drug-def-eheatmap, fig.cap="河南省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_henan_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 黑龙江省

```{r year-quarter-heilongjiang-drug}
year_quarter_heilongjiang_drug <- year_quarter_province_drug %>%
  filter(province == "黑龙江省")
```

(ref:year-quarter-heilongjiang-drug) 黑龙江省各年份各季度各农药检出率与合格率

```{r year-quarter-heilongjiang-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_heilongjiang_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-heilongjiang-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-heilongjiang-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度黑龙江省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-heilongjiang-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-heilongjiang-drug-def-eheatmap)。可以看出，黑龙江省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_heilongjiang_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_heilongjiang_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_heilongjiang_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-heilongjiang-drug-det-eheatmap, fig.cap="黑龙江省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_heilongjiang_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-heilongjiang-drug-def-eheatmap, fig.cap="黑龙江省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_heilongjiang_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 湖北省

```{r year-quarter-hubei-drug}
year_quarter_hubei_drug <- year_quarter_province_drug %>%
  filter(province == "湖北省")
```

(ref:year-quarter-hubei-drug) 湖北省各年份各季度各农药检出率与合格率

```{r year-quarter-hubei-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_hubei_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-hubei-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-hubei-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度湖北省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-hubei-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-hubei-drug-def-eheatmap)。可以看出，湖北省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_hubei_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_hubei_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_hubei_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-hubei-drug-det-eheatmap, fig.cap="湖北省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_hubei_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-hubei-drug-def-eheatmap, fig.cap="湖北省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_hubei_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 湖南省

```{r year-quarter-hunan-drug}
year_quarter_hunan_drug <- year_quarter_province_drug %>%
  filter(province == "湖南省")
```

(ref:year-quarter-hunan-drug) 湖南省各年份各季度各农药检出率与合格率

```{r year-quarter-hunan-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_hunan_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-hunan-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-hunan-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度湖南省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-hunan-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-hunan-drug-def-eheatmap)。可以看出，湖南省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_hunan_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_hunan_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_hunan_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-hunan-drug-det-eheatmap, fig.cap="湖南省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_hunan_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-hunan-drug-def-eheatmap, fig.cap="湖南省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_hunan_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 吉林省

```{r year-quarter-jiling-drug}
year_quarter_jiling_drug <- year_quarter_province_drug %>%
  filter(province == "吉林省")
```

(ref:year-quarter-jiling-drug) 吉林省各年份各季度各农药检出率与合格率

```{r year-quarter-jiling-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_jiling_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-jiling-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-jiling-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度吉林省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-jiling-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-jiling-drug-def-eheatmap)。可以看出，吉林省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_jiling_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_jiling_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_jiling_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-jiling-drug-det-eheatmap, fig.cap="吉林省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_jiling_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-jiling-drug-def-eheatmap, fig.cap="吉林省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_jiling_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 江苏省

```{r year-quarter-jiangsu-drug}
year_quarter_jiangsu_drug <- year_quarter_province_drug %>%
  filter(province == "江苏省")
```

(ref:year-quarter-jiangsu-drug) 江苏省各年份各季度各农药检出率与合格率

```{r year-quarter-jiangsu-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_jiangsu_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-jiangsu-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-jiangsu-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度江苏省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-jiangsu-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-jiangsu-drug-def-eheatmap)。可以看出，江苏省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_jiangsu_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_jiangsu_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_jiangsu_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-jiangsu-drug-det-eheatmap, fig.cap="江苏省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_jiangsu_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-jiangsu-drug-def-eheatmap, fig.cap="江苏省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_jiangsu_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 江西省

```{r year-quarter-jiangxi-drug}
year_quarter_jiangxi_drug <- year_quarter_province_drug %>%
  filter(province == "江西省")
```

(ref:year-quarter-jiangxi-drug) 江西省各年份各季度各农药检出率与合格率

```{r year-quarter-jiangxi-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_jiangxi_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-jiangxi-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-jiangxi-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度江西省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-jiangxi-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-jiangxi-drug-def-eheatmap)。可以看出，江西省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_jiangxi_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_jiangxi_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_jiangxi_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-jiangxi-drug-det-eheatmap, fig.cap="江西省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_jiangxi_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-jiangxi-drug-def-eheatmap, fig.cap="江西省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_jiangxi_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 辽宁省

```{r year-quarter-liaoning-drug}
year_quarter_liaoning_drug <- year_quarter_province_drug %>%
  filter(province == "辽宁省")
```

(ref:year-quarter-liaoning-drug) 辽宁省各年份各季度各农药检出率与合格率

```{r year-quarter-liaoning-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_liaoning_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-liaoning-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-liaoning-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度辽宁省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-liaoning-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-liaoning-drug-def-eheatmap)。可以看出，辽宁省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_liaoning_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_liaoning_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_liaoning_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-liaoning-drug-det-eheatmap, fig.cap="辽宁省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_liaoning_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-liaoning-drug-def-eheatmap, fig.cap="辽宁省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_liaoning_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 内蒙古自治区

```{r year-quarter-neimenggu-drug}
year_quarter_neimenggu_drug <- year_quarter_province_drug %>%
  filter(province == "内蒙古自治区")
```

(ref:year-quarter-neimenggu-drug) 内蒙古自治区各年份各季度各农药检出率与合格率

```{r year-quarter-neimenggu-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_neimenggu_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-neimenggu-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-neimenggu-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度内蒙古自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-neimenggu-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-neimenggu-drug-def-eheatmap)。可以看出，内蒙古自治区各年各季度各农药的抽检样本量在 `r text_range(year_quarter_neimenggu_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_neimenggu_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_neimenggu_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-neimenggu-drug-det-eheatmap, fig.cap="内蒙古自治区各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_neimenggu_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-neimenggu-drug-def-eheatmap, fig.cap="内蒙古自治区各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_neimenggu_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 宁夏回族自治区

```{r year-quarter-ningxia-drug}
year_quarter_ningxia_drug <- year_quarter_province_drug %>%
  filter(province == "宁夏回族自治区")
```

(ref:year-quarter-ningxia-drug) 宁夏回族自治区各年份各季度各农药检出率与合格率

```{r year-quarter-ningxia-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_ningxia_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-ningxia-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-ningxia-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度宁夏回族自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-ningxia-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-ningxia-drug-def-eheatmap)。可以看出，宁夏回族自治区各年各季度各农药的抽检样本量在 `r text_range(year_quarter_ningxia_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_ningxia_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_ningxia_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-ningxia-drug-det-eheatmap, fig.cap="宁夏回族自治区各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_ningxia_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-ningxia-drug-def-eheatmap, fig.cap="宁夏回族自治区各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_ningxia_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 青海省

```{r year-quarter-qinghai-drug}
year_quarter_qinghai_drug <- year_quarter_province_drug %>%
  filter(province == "青海省")
```

(ref:year-quarter-qinghai-drug) 青海省各年份各季度各农药检出率与合格率

```{r year-quarter-qinghai-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_qinghai_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-qinghai-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-qinghai-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度青海省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-qinghai-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-qinghai-drug-def-eheatmap)。可以看出，青海省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_qinghai_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_qinghai_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_qinghai_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-qinghai-drug-det-eheatmap, fig.cap="青海省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_qinghai_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-qinghai-drug-def-eheatmap, fig.cap="青海省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_qinghai_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 山东省

```{r year-quarter-shandong-drug}
year_quarter_shandong_drug <- year_quarter_province_drug %>%
  filter(province == "山东省")
```

(ref:year-quarter-shandong-drug) 山东省各年份各季度各农药检出率与合格率

```{r year-quarter-shandong-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_shandong_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-shandong-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-shandong-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度山东省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-shandong-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-shandong-drug-def-eheatmap)。可以看出，山东省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_shandong_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_shandong_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_shandong_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-shandong-drug-det-eheatmap, fig.cap="山东省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_shandong_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-shandong-drug-def-eheatmap, fig.cap="山东省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_shandong_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 山西省

```{r year-quarter-shan1xi-drug}
year_quarter_shan1xi_drug <- year_quarter_province_drug %>%
  filter(province == "山西省")
```

(ref:year-quarter-shan1xi-drug) 山西省各年份各季度各农药检出率与合格率

```{r year-quarter-shan1xi-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_shan1xi_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-shan1xi-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-shan1xi-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度山西省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-shan1xi-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-shan1xi-drug-def-eheatmap)。可以看出，山西省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_shan1xi_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_shan1xi_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_shan1xi_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-shan1xi-drug-det-eheatmap, fig.cap="山西省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_shan1xi_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-shan1xi-drug-def-eheatmap, fig.cap="山西省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_shan1xi_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 陕西省

```{r year-quarter-shan3xi-drug}
year_quarter_shan3xi_drug <- year_quarter_province_drug %>%
  filter(province == "陕西省")
```

(ref:year-quarter-shan3xi-drug) 陕西省各年份各季度各农药检出率与合格率

```{r year-quarter-shan3xi-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_shan3xi_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-shan3xi-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-shan3xi-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度陕西省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-shan3xi-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-shan3xi-drug-def-eheatmap)。可以看出，陕西省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_shan3xi_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_shan3xi_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_shan3xi_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-shan3xi-drug-det-eheatmap, fig.cap="陕西省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_shan3xi_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-shan3xi-drug-def-eheatmap, fig.cap="陕西省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_shan3xi_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 上海市

```{r year-quarter-shanghai-drug}
year_quarter_shanghai_drug <- year_quarter_province_drug %>%
  filter(province == "上海市")
```

(ref:year-quarter-shanghai-drug) 上海市各年份各季度各农药检出率与合格率

```{r year-quarter-shanghai-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_shanghai_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-shanghai-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-shanghai-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度上海市在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-shanghai-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-shanghai-drug-def-eheatmap)。可以看出，上海市各年各季度各农药的抽检样本量在 `r text_range(year_quarter_shanghai_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_shanghai_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_shanghai_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-shanghai-drug-det-eheatmap, fig.cap="上海市各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_shanghai_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-shanghai-drug-def-eheatmap, fig.cap="上海市各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_shanghai_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 四川省

```{r year-quarter-sichuan-drug}
year_quarter_sichuan_drug <- year_quarter_province_drug %>%
  filter(province == "四川省")
```

(ref:year-quarter-sichuan-drug) 四川省各年份各季度各农药检出率与合格率

```{r year-quarter-sichuan-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_sichuan_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-sichuan-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-sichuan-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度四川省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-sichuan-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-sichuan-drug-def-eheatmap)。可以看出，四川省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_sichuan_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_sichuan_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_sichuan_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-sichuan-drug-det-eheatmap, fig.cap="四川省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_sichuan_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-sichuan-drug-def-eheatmap, fig.cap="四川省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_sichuan_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 天津市

```{r year-quarter-tianjin-drug}
year_quarter_tianjin_drug <- year_quarter_province_drug %>%
  filter(province == "天津市")
```

(ref:year-quarter-tianjin-drug) 天津市各年份各季度各农药检出率与合格率

```{r year-quarter-tianjin-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_tianjin_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-tianjin-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-tianjin-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度天津市在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-tianjin-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-tianjin-drug-def-eheatmap)。可以看出，天津市各年各季度各农药的抽检样本量在 `r text_range(year_quarter_tianjin_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_tianjin_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_tianjin_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-tianjin-drug-det-eheatmap, fig.cap="天津市各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_tianjin_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-tianjin-drug-def-eheatmap, fig.cap="天津市各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_tianjin_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 西藏自治区

```{r year-quarter-xizang-drug}
year_quarter_xizang_drug <- year_quarter_province_drug %>%
  filter(province == "西藏自治区")
```

(ref:year-quarter-xizang-drug) 西藏自治区各年份各季度各农药检出率与合格率

```{r year-quarter-xizang-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_xizang_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-xizang-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-xizang-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度西藏自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-xizang-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-xizang-drug-def-eheatmap)。可以看出，西藏自治区各年各季度各农药的抽检样本量在 `r text_range(year_quarter_xizang_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_xizang_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_xizang_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-xizang-drug-det-eheatmap, fig.cap="西藏自治区各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_xizang_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-xizang-drug-def-eheatmap, fig.cap="西藏自治区各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_xizang_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 新疆维吾尔自治区

```{r year-quarter-xinjiang-drug}
year_quarter_xinjiang_drug <- year_quarter_province_drug %>%
  filter(province == "新疆维吾尔自治区")
```

(ref:year-quarter-xinjiang-drug) 新疆维吾尔自治区各年份各季度各农药检出率与合格率

```{r year-quarter-xinjiang-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_xinjiang_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-xinjiang-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-xinjiang-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度新疆维吾尔自治区在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-xinjiang-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-xinjiang-drug-def-eheatmap)。可以看出，新疆维吾尔自治区各年各季度各农药的抽检样本量在 `r text_range(year_quarter_xinjiang_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_xinjiang_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_xinjiang_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-xinjiang-drug-det-eheatmap, fig.cap="新疆维吾尔自治区各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_xinjiang_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-xinjiang-drug-def-eheatmap, fig.cap="新疆维吾尔自治区各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_xinjiang_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 云南省

```{r year-quarter-yunnan-drug}
year_quarter_yunnan_drug <- year_quarter_province_drug %>%
  filter(province == "云南省")
```

(ref:year-quarter-yunnan-drug) 云南省各年份各季度各农药检出率与合格率

```{r year-quarter-yunnan-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_yunnan_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-yunnan-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-yunnan-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度云南省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-yunnan-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-yunnan-drug-def-eheatmap)。可以看出，云南省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_yunnan_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_yunnan_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_yunnan_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-yunnan-drug-det-eheatmap, fig.cap="云南省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_yunnan_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-yunnan-drug-def-eheatmap, fig.cap="云南省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_yunnan_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 浙江省

```{r year-quarter-zhejiang-drug}
year_quarter_zhejiang_drug <- year_quarter_province_drug %>%
  filter(province == "浙江省")
```

(ref:year-quarter-zhejiang-drug) 浙江省各年份各季度各农药检出率与合格率

```{r year-quarter-zhejiang-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_zhejiang_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-zhejiang-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-zhejiang-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度浙江省在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-zhejiang-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-zhejiang-drug-def-eheatmap)。可以看出，浙江省各年各季度各农药的抽检样本量在 `r text_range(year_quarter_zhejiang_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_zhejiang_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_zhejiang_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-zhejiang-drug-det-eheatmap, fig.cap="浙江省各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_zhejiang_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-zhejiang-drug-def-eheatmap, fig.cap="浙江省各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_zhejiang_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

### 重庆市

```{r year-quarter-chongqing-drug}
year_quarter_chongqing_drug <- year_quarter_province_drug %>%
  filter(province == "重庆市")
```

(ref:year-quarter-chongqing-drug) 重庆市各年份各季度各农药检出率与合格率

```{r year-quarter-chongqing-drug-table, results="asis", dev='png'}
sp_dable(year_quarter_chongqing_drug %>% factor_dims(year, quarter, drug), ref_text = "(ref:year-quarter-chongqing-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-quarter-chongqing-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度重庆市在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-chongqing-drug-det-eheatmap) - 图 \@ref(fig:year-quarter-chongqing-drug-def-eheatmap)。可以看出，重庆市各年各季度各农药的抽检样本量在 `r text_range(year_quarter_chongqing_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_chongqing_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_chongqing_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-chongqing-drug-det-eheatmap, fig.cap="重庆市各年份各季度各药物检出率热力图"}
heatmap(
  year_quarter_chongqing_drug %>% combine_year_quarter() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "detection_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-chongqing-drug-def-eheatmap, fig.cap="重庆市各年份各季度各药物超标率热力图"}
heatmap(
  year_quarter_chongqing_drug %>% combine_year_quarter() %>% change_to_defective() %>% shorten_province_name(), 
  x_var = "drug", y_var = "timeline", value_var = "defective_rate_percent",
  y_axis_name = "年份-季度", x_label_fontsize = 11, height = "400%"
)
```


## “年份-季度-蔬菜类别-药品”残留风险

```{r year-quarter-category-drug, cache=!params$product_env}
year_quarter_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, category, drug
)
```

(ref:year-quarter-category-drug) 各年份各季度各蔬菜类别各农药检出率与合格率

`r text_threshold(data = year_quarter_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "category", "drug"))`

```{r year-quarter-category-drug-table, results="asis", dev='png'}
sp_dable(
  year_quarter_category_drug %>% 
    factor_dims(year, quarter, category, drug), 
  ref_text = "(ref:year-quarter-category-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-category-drug) 给出了 `r year_range[1]` 年第一季度 `r year_range[2]` 年第四季度 `r nrow(category)` 个蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:year-quarter-category-drug-det-eheatmap) 和图 \@ref(fig:year-quarter-category-drug-def-eheatmap)。可以看出，各年份各季度各蔬菜类别各农药的抽检样本量在 `r text_range(year_quarter_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_category_drug, "qualification_rate_percent")` 之间。

```{r year-quarter-category-drug-det-eheatmap, fig.cap="各年份各季度各蔬菜类别各药物检出率热力图"}
heatmap(
  year_quarter_category_drug %>% combine_year_quarter() %>% factor_dims(category, drug),
  timeline_var = "timeline", 
  x_var = "drug", y_var = "category", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r year-quarter-category-drug-def-eheatmap, fig.cap="各年份各季度各蔬菜类别各药物超标率热力图"}
heatmap(
  year_quarter_category_drug %>% combine_year_quarter() %>% change_to_defective() %>% factor_dims(category, drug),
  timeline_var = "timeline", 
  x_var = "drug", y_var = "category", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

## “年份-季度-品种-药品”残留风险

```{r year-quarter-product-drug, cache=!params$product_env}
year_quarter_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, product, drug
)
```

`r text_threshold(data = year_quarter_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "product", "drug"))`

(ref:year-quarter-product-drug) 各年份各季度各品种各农药检出率与合格率

```{r year-quarter-product-drug-table, results="asis", dev='png', eval=FALSE}
sp_dable(
  year_quarter_product_drug %>% 
    factor_dims(year, quarter, product, drug), 
  ref_text = "(ref:year-quarter-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2016-1-product-drug) - 表 \@ref(tab:2020-4-product-drug) 给出了 `r year_range[1]` 年第一季度 `r year_range[2]` 年第四季度 `r nrow(product)` 个蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2016-1-product-drug-det-eheatmap) - 图 \@ref(fig:2020-4-product-drug-def-eheatmap)。可以看出，各年份各季度各蔬菜品种各农药的抽检样本量在 `r text_range(year_quarter_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_product_drug, "qualification_rate_percent")` 之间。

### 2016 年第一季度

```{r 2016-1-product-drug}
product_drug_2016_1 <- year_quarter_product_drug %>%
  filter(year == 2016, quarter == 1)
```

(ref:2016-1-product-drug) 2016年第一季度各品种各农药检出率与合格率

```{r 2016-1-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2016_1 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2016-1-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2016-1-product-drug) 给出了 2016 年第一季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2016-1-product-drug-det-eheatmap) - 图 \@ref(fig:2016-1-product-drug-def-eheatmap)。可以看出，2016 年第一季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2016_1, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2016_1, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2016_1, "qualification_rate_percent")` 之间。

```{r 2016-1-product-drug-det-eheatmap, fig.cap="2016年第一季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2016_1,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2016-1-product-drug-def-eheatmap, fig.cap="2016年第一季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2016_1 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2016 年第二季度

```{r 2016-2-product-drug}
product_drug_2016_2 <- year_quarter_product_drug %>%
  filter(year == 2016, quarter == 2)
```

(ref:2016-2-product-drug) 2016年第二季度各品种各农药检出率与合格率

```{r 2016-2-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2016_2 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2016-2-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2016-2-product-drug) 给出了 2016 年第二季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2016-2-product-drug-det-eheatmap) - 图 \@ref(fig:2016-2-product-drug-def-eheatmap)。可以看出，2016 年第二季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2016_2, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2016_2, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2016_2, "qualification_rate_percent")` 之间。

```{r 2016-2-product-drug-det-eheatmap, fig.cap="2016年第二季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2016_2,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2016-2-product-drug-def-eheatmap, fig.cap="2016年第二季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2016_2 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2016 年第三季度

```{r 2016-3-product-drug}
product_drug_2016_3 <- year_quarter_product_drug %>%
  filter(year == 2016, quarter == 3)
```

(ref:2016-3-product-drug) 2016年第三季度各品种各农药检出率与合格率

```{r 2016-3-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2016_3 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2016-3-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2016-3-product-drug) 给出了 2016 年第三季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2016-3-product-drug-det-eheatmap) - 图 \@ref(fig:2016-3-product-drug-def-eheatmap)。可以看出，2016 年第三季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2016_3, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2016_3, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2016_3, "qualification_rate_percent")` 之间。

```{r 2016-3-product-drug-det-eheatmap, fig.cap="2016年第三季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2016_3,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2016-3-product-drug-def-eheatmap, fig.cap="2016年第三季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2016_3 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2016 年第四季度

```{r 2016-4-product-drug}
product_drug_2016_4 <- year_quarter_product_drug %>%
  filter(year == 2016, quarter == 4)
```

(ref:2016-4-product-drug) 2016年第四季度各品种各农药检出率与合格率

```{r 2016-4-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2016_4 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2016-4-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2016-4-product-drug) 给出了 2016 年第四季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2016-4-product-drug-det-eheatmap) - 图 \@ref(fig:2016-4-product-drug-def-eheatmap)。可以看出，2016 年第四季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2016_4, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2016_4, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2016_4, "qualification_rate_percent")` 之间。

```{r 2016-4-product-drug-det-eheatmap, fig.cap="2016年第四季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2016_4,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2016-4-product-drug-def-eheatmap, fig.cap="2016年第四季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2016_4 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2017 年第一季度

```{r 2017-1-product-drug}
product_drug_2017_1 <- year_quarter_product_drug %>%
  filter(year == 2017, quarter == 1)
```

(ref:2017-1-product-drug) 2017年第一季度各品种各农药检出率与合格率

```{r 2017-1-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2017_1 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2017-1-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2017-1-product-drug) 给出了 2017 年第一季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2017-1-product-drug-det-eheatmap) - 图 \@ref(fig:2017-1-product-drug-def-eheatmap)。可以看出，2017 年第一季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2017_1, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2017_1, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2017_1, "qualification_rate_percent")` 之间。

```{r 2017-1-product-drug-det-eheatmap, fig.cap="2017年第一季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2017_1,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2017-1-product-drug-def-eheatmap, fig.cap="2017年第一季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2017_1 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2017 年第二季度

```{r 2017-2-product-drug}
product_drug_2017_2 <- year_quarter_product_drug %>%
  filter(year == 2017, quarter == 2)
```

(ref:2017-2-product-drug) 2017年第二季度各品种各农药检出率与合格率

```{r 2017-2-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2017_2 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2017-2-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2017-2-product-drug) 给出了 2017 年第二季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2017-2-product-drug-det-eheatmap) - 图 \@ref(fig:2017-2-product-drug-def-eheatmap)。可以看出，2017 年第二季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2017_2, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2017_2, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2017_2, "qualification_rate_percent")` 之间。

```{r 2017-2-product-drug-det-eheatmap, fig.cap="2017年第二季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2017_2,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2017-2-product-drug-def-eheatmap, fig.cap="2017年第二季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2017_2 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2017 年第三季度

```{r 2017-3-product-drug}
product_drug_2017_3 <- year_quarter_product_drug %>%
  filter(year == 2017, quarter == 3)
```

(ref:2017-3-product-drug) 2017年第三季度各品种各农药检出率与合格率

```{r 2017-3-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2017_3 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2017-3-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2017-3-product-drug) 给出了 2017 年第三季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2017-3-product-drug-det-eheatmap) - 图 \@ref(fig:2017-3-product-drug-def-eheatmap)。可以看出，2017 年第三季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2017_3, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2017_3, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2017_3, "qualification_rate_percent")` 之间。

```{r 2017-3-product-drug-det-eheatmap, fig.cap="2017年第三季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2017_3,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2017-3-product-drug-def-eheatmap, fig.cap="2017年第三季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2017_3 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2017 年第四季度

```{r 2017-4-product-drug}
product_drug_2017_4 <- year_quarter_product_drug %>%
  filter(year == 2017, quarter == 4)
```

(ref:2017-4-product-drug) 2017年第四季度各品种各农药检出率与合格率

```{r 2017-4-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2017_4 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2017-4-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2017-4-product-drug) 给出了 2017 年第四季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2017-4-product-drug-det-eheatmap) - 图 \@ref(fig:2017-4-product-drug-def-eheatmap)。可以看出，2017 年第四季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2017_4, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2017_4, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2017_4, "qualification_rate_percent")` 之间。

```{r 2017-4-product-drug-det-eheatmap, fig.cap="2017年第四季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2017_4,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2017-4-product-drug-def-eheatmap, fig.cap="2017年第四季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2017_4 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2018 年第一季度

```{r 2018-1-product-drug}
product_drug_2018_1 <- year_quarter_product_drug %>%
  filter(year == 2018, quarter == 1)
```

(ref:2018-1-product-drug) 2018年第一季度各品种各农药检出率与合格率

```{r 2018-1-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2018_1 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2018-1-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2018-1-product-drug) 给出了 2018 年第一季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2018-1-product-drug-det-eheatmap) - 图 \@ref(fig:2018-1-product-drug-def-eheatmap)。可以看出，2018 年第一季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2018_1, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2018_1, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2018_1, "qualification_rate_percent")` 之间。

```{r 2018-1-product-drug-det-eheatmap, fig.cap="2018年第一季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2018_1,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2018-1-product-drug-def-eheatmap, fig.cap="2018年第一季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2018_1 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2018 年第二季度

```{r 2018-2-product-drug}
product_drug_2018_2 <- year_quarter_product_drug %>%
  filter(year == 2018, quarter == 2)
```

(ref:2018-2-product-drug) 2018年第二季度各品种各农药检出率与合格率

```{r 2018-2-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2018_2 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2018-2-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2018-2-product-drug) 给出了 2018 年第二季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2018-2-product-drug-det-eheatmap) - 图 \@ref(fig:2018-2-product-drug-def-eheatmap)。可以看出，2018 年第二季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2018_2, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2018_2, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2018_2, "qualification_rate_percent")` 之间。

```{r 2018-2-product-drug-det-eheatmap, fig.cap="2018年第二季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2018_2,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2018-2-product-drug-def-eheatmap, fig.cap="2018年第二季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2018_2 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2018 年第三季度

```{r 2018-3-product-drug}
product_drug_2018_3 <- year_quarter_product_drug %>%
  filter(year == 2018, quarter == 3)
```

(ref:2018-3-product-drug) 2018年第三季度各品种各农药检出率与合格率

```{r 2018-3-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2018_3 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2018-3-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2018-3-product-drug) 给出了 2018 年第三季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2018-3-product-drug-det-eheatmap) - 图 \@ref(fig:2018-3-product-drug-def-eheatmap)。可以看出，2018 年第三季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2018_3, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2018_3, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2018_3, "qualification_rate_percent")` 之间。

```{r 2018-3-product-drug-det-eheatmap, fig.cap="2018年第三季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2018_3,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2018-3-product-drug-def-eheatmap, fig.cap="2018年第三季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2018_3 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2018 年第四季度

```{r 2018-4-product-drug}
product_drug_2018_4 <- year_quarter_product_drug %>%
  filter(year == 2018, quarter == 4)
```

(ref:2018-4-product-drug) 2018年第四季度各品种各农药检出率与合格率

```{r 2018-4-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2018_4 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2018-4-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2018-4-product-drug) 给出了 2018 年第四季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2018-4-product-drug-det-eheatmap) - 图 \@ref(fig:2018-4-product-drug-def-eheatmap)。可以看出，2018 年第四季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2018_4, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2018_4, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2018_4, "qualification_rate_percent")` 之间。

```{r 2018-4-product-drug-det-eheatmap, fig.cap="2018年第四季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2018_4,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2018-4-product-drug-def-eheatmap, fig.cap="2018年第四季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2018_4 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2019 年第一季度

```{r 2019-1-product-drug}
product_drug_2019_1 <- year_quarter_product_drug %>%
  filter(year == 2019, quarter == 1)
```

(ref:2019-1-product-drug) 2019年第一季度各品种各农药检出率与合格率

```{r 2019-1-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2019_1 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2019-1-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2019-1-product-drug) 给出了 2019 年第一季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2019-1-product-drug-det-eheatmap) - 图 \@ref(fig:2019-1-product-drug-def-eheatmap)。可以看出，2019 年第一季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2019_1, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2019_1, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2019_1, "qualification_rate_percent")` 之间。

```{r 2019-1-product-drug-det-eheatmap, fig.cap="2019年第一季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2019_1,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2019-1-product-drug-def-eheatmap, fig.cap="2019年第一季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2019_1 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2019 年第二季度

```{r 2019-2-product-drug}
product_drug_2019_2 <- year_quarter_product_drug %>%
  filter(year == 2019, quarter == 2)
```

(ref:2019-2-product-drug) 2019年第二季度各品种各农药检出率与合格率

```{r 2019-2-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2019_2 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2019-2-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2019-2-product-drug) 给出了 2019 年第二季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2019-2-product-drug-det-eheatmap) - 图 \@ref(fig:2019-2-product-drug-def-eheatmap)。可以看出，2019 年第二季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2019_2, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2019_2, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2019_2, "qualification_rate_percent")` 之间。

```{r 2019-2-product-drug-det-eheatmap, fig.cap="2019年第二季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2019_2,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2019-2-product-drug-def-eheatmap, fig.cap="2019年第二季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2019_2 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2019 年第三季度

```{r 2019-3-product-drug}
product_drug_2019_3 <- year_quarter_product_drug %>%
  filter(year == 2019, quarter == 3)
```

(ref:2019-3-product-drug) 2019年第三季度各品种各农药检出率与合格率

```{r 2019-3-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2019_3 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2019-3-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2019-3-product-drug) 给出了 2019 年第三季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2019-3-product-drug-det-eheatmap) - 图 \@ref(fig:2019-3-product-drug-def-eheatmap)。可以看出，2019 年第三季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2019_3, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2019_3, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2019_3, "qualification_rate_percent")` 之间。

```{r 2019-3-product-drug-det-eheatmap, fig.cap="2019年第三季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2019_3,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2019-3-product-drug-def-eheatmap, fig.cap="2019年第三季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2019_3 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2019 年第四季度

```{r 2019-4-product-drug}
product_drug_2019_4 <- year_quarter_product_drug %>%
  filter(year == 2019, quarter == 4)
```

(ref:2019-4-product-drug) 2019年第四季度各品种各农药检出率与合格率

```{r 2019-4-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2019_4 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2019-4-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2019-4-product-drug) 给出了 2019 年第四季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2019-4-product-drug-det-eheatmap) - 图 \@ref(fig:2019-4-product-drug-def-eheatmap)。可以看出，2019 年第四季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2019_4, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2019_4, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2019_4, "qualification_rate_percent")` 之间。

```{r 2019-4-product-drug-det-eheatmap, fig.cap="2019年第四季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2019_4,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2019-4-product-drug-def-eheatmap, fig.cap="2019年第四季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2019_4 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2020 年第一季度

```{r 2020-1-product-drug}
product_drug_2020_1 <- year_quarter_product_drug %>%
  filter(year == 2020, quarter == 1)
```

(ref:2020-1-product-drug) 2020年第一季度各品种各农药检出率与合格率

```{r 2020-1-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2020_1 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2020-1-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2020-1-product-drug) 给出了 2020 年第一季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2020-1-product-drug-det-eheatmap) - 图 \@ref(fig:2020-1-product-drug-def-eheatmap)。可以看出，2020 年第一季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2020_1, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2020_1, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2020_1, "qualification_rate_percent")` 之间。

```{r 2020-1-product-drug-det-eheatmap, fig.cap="2020年第一季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2020_1,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2020-1-product-drug-def-eheatmap, fig.cap="2020年第一季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2020_1 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2020 年第二季度

```{r 2020-2-product-drug}
product_drug_2020_2 <- year_quarter_product_drug %>%
  filter(year == 2020, quarter == 2)
```

(ref:2020-2-product-drug) 2020年第二季度各品种各农药检出率与合格率

```{r 2020-2-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2020_2 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2020-2-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2020-2-product-drug) 给出了 2020 年第二季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2020-2-product-drug-det-eheatmap) - 图 \@ref(fig:2020-2-product-drug-def-eheatmap)。可以看出，2020 年第二季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2020_2, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2020_2, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2020_2, "qualification_rate_percent")` 之间。

```{r 2020-2-product-drug-det-eheatmap, fig.cap="2020年第二季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2020_2,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2020-2-product-drug-def-eheatmap, fig.cap="2020年第二季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2020_2 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2020 年第三季度

```{r 2020-3-product-drug}
product_drug_2020_3 <- year_quarter_product_drug %>%
  filter(year == 2020, quarter == 3)
```

(ref:2020-3-product-drug) 2020年第三季度各品种各农药检出率与合格率

```{r 2020-3-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2020_3 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2020-3-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2020-3-product-drug) 给出了 2020 年第三季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2020-3-product-drug-det-eheatmap) - 图 \@ref(fig:2020-3-product-drug-def-eheatmap)。可以看出，2020 年第三季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2020_3, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2020_3, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2020_3, "qualification_rate_percent")` 之间。

```{r 2020-3-product-drug-det-eheatmap, fig.cap="2020年第三季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2020_3,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2020-3-product-drug-def-eheatmap, fig.cap="2020年第三季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2020_3 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

### 2020 年第四季度

```{r 2020-4-product-drug}
product_drug_2020_4 <- year_quarter_product_drug %>%
  filter(year == 2020, quarter == 4)
```

(ref:2020-4-product-drug) 2020年第四季度各品种各农药检出率与合格率

```{r 2020-4-product-drug-table, results="asis", dev='png'}
sp_dable(
  product_drug_2020_4 %>% factor_dims(year, quarter, product, drug),
  ref_text = "(ref:2020-4-product-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:2020-4-product-drug) 给出了 2020 年第四季度 `r nrow(product)` 种蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率，其图形展示见图 \@ref(fig:2020-4-product-drug-det-eheatmap) - 图 \@ref(fig:2020-4-product-drug-def-eheatmap)。可以看出，2020 年第四季度各蔬菜品种各农药的抽检样本量在 `r text_range(product_drug_2020_4, "sample_size")` 之间，检出率稳定在 `r text_range(product_drug_2020_4, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(product_drug_2020_4, "qualification_rate_percent")` 之间。

```{r 2020-4-product-drug-det-eheatmap, fig.cap="2020年第四季度各品种各药物检出率热力图"}
heatmap(
  product_drug_2020_4,
  x_var = "drug", y_var = "product", value_var = "detection_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

```{r 2020-4-product-drug-def-eheatmap, fig.cap="2020年第四季度各品种各药物超标率热力图"}
heatmap(
  product_drug_2020_4 %>% change_to_defective(),
  x_var = "drug", y_var = "product", value_var = "defective_rate_percent",
  x_label_fontsize = 11, height = "400%"
)
```

## “年份-省份-蔬菜类别-药品”残留风险

```{r year-province-category-drug, cache=!params$product_env}
year_province_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, province, category, drug
) %>%
  factor_dims(year, province, category, drug)
```

`r text_threshold(data = year_province_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province", "category", "drug"))`

(ref:year-province-category-drug) 各年份各省份各蔬菜类别各农药检出率与合格率

```{r year-province-category-drug-table, results="asis", dev='png'}
sp_dable(year_province_category_drug, ref_text = "(ref:year-province-category-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-province-category-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(province)` 个省市自治区 `r nrow(category)` 个蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各年份各省市自治区各蔬菜类别各农药的抽检样本量在 `r text_range(year_province_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_province_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_province_category_drug, "qualification_rate_percent")` 之间。

## “年份-省份-品种-药品”残留风险

```{r year-province-product-drug, cache=!params$product_env}
year_province_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, province, product, drug
) %>%
  factor_dims(year, province, product, drug)
```

`r text_threshold(data = year_product_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "province", "product", "drug"))`

(ref:year-province-product-drug) 各年份各省份各品种各农药检出率与合格率

```{r year-province-product-drug-table, results="asis", dev='png'}
sp_dable(year_province_product_drug, ref_text = "(ref:year-province-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:year-province-product-drug) 给出了 `r year_range[1]` - `r year_range[2]` 年 `r nrow(province)` 个省市自治区 `r nrow(product)` 个蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各年份各省市自治区各蔬菜品种各农药的抽检样本量在 `r text_range(year_province_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_province_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_province_product_drug, "qualification_rate_percent")` 之间。

## “季度-省份-蔬菜类别-药品”残留风险

```{r quarter-province-category-drug, cache=!params$product_env}
quarter_province_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  quarter, province, category, drug
) %>%
  factor_dims(quarter, province, category, drug)
```

`r text_threshold(data = quarter_province_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province", "category", "drug"))`

(ref:quarter-province-category-drug) 各季度各省份各蔬菜类别各农药检出率与合格率

```{r quarter-province-category-drug-table, results="asis", dev='png'}
sp_dable(
  quarter_province_category_drug, 
  ref_text = "(ref:quarter-province-category-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:quarter-province-category-drug) 给出了 `r nrow(province)` 个省市自治区 `r nrow(category)` 个蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各季度各省市自治区各蔬菜类别各农药的抽检样本量在 `r text_range(quarter_province_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_province_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_province_category_drug, "qualification_rate_percent")` 之间。

## “季度-省份-品种-药品”残留风险

```{r quarter-province-product-drug, cache=!params$product_env}
quarter_province_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  quarter, province, product, drug
) %>%
  factor_dims(quarter, province, product, drug)
```

`r text_threshold(data = quarter_province_product_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("quarter", "province", "product", "drug"))`

(ref:quarter-province-product-drug) 各季度各省份各品种各农药检出率与合格率

```{r quarter-province-product-drug-table, results="asis", dev='png'}
sp_dable(quarter_province_product_drug, ref_text = "(ref:quarter-province-product-drug)")
```

&emsp;&emsp;表 \@ref(tab:quarter-province-product-drug) 给出了 `r nrow(province)` 个省市自治区 `r nrow(product)` 个蔬菜品种在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各季度各省市自治区各蔬菜品种各农药的抽检样本量在 `r text_range(quarter_province_product_drug, "sample_size")` 之间，检出率稳定在 `r text_range(quarter_province_product_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(quarter_province_product_drug, "qualification_rate_percent")` 之间。

## “年份-季度-省份-产品类别-药品”残留风险

```{r year-quarter-province-category-drug, cache=!params$product_env}
year_quarter_province_category_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, province, category, drug
) %>%
  factor_dims(year, quarter, province, category, drug)
```

`r text_threshold(data = year_quarter_province_category_drug, threshold_data = ana_threshold, dims = dims, ana_dims = c("year", "quarter", "province", "category", "drug"))`

(ref:year-quarter-province-category-drug) 各年份各季度各省份各蔬菜类别各农药检出率与合格率

```{r year-quarter-province-category-drug-table, results="asis", dev='png'}
sp_dable(
  year_quarter_province_category_drug, 
  ref_text = "(ref:year-quarter-province-category-drug)"
)
```

&emsp;&emsp;表 \@ref(tab:year-quarter-province-category-drug) 给出了 `r year_range[1]` 年第一季度到 `r year_range[2]` 年第四季度 `r nrow(province)` 个省市自治区 `r nrow(category)` 个蔬菜类别在 `r nrow(drug)` 种农药上的抽检样本量、检出率及合格率。可以看出，各年份各季度各省市自治区各蔬菜类别各农药的抽检样本量在 `r text_range(year_quarter_province_category_drug, "sample_size")` 之间，检出率稳定在 `r text_range(year_quarter_province_category_drug, "detection_rate_percent")` 之间，合格率稳定在 `r text_range(year_quarter_province_category_drug, "qualification_rate_percent")` 之间。

`r if (FALSE) '
## “年份-季度-省份-品种-药品”残留风险（不分析）
'`

```{r year-quarter-province-product-drug, eval=FALSE}
year_quarter_province_product_drug <- spec_dataset(
  dims_comb_data, dims, ana_threshold, "product_drug", 
  year, quarter, province, product, drug
) %>%
  factor_dims(year, quarter, province, product, drug)
```

(ref:year-quarter-province-product-drug) 各年份各季度各省份各品种各农药检出率与合格率

```{r year-quarter-province-product-drug-table, results="asis", dev='png', eval=FALSE}
sp_dable(
  year_quarter_province_product_drug, 
  ref_text = "(ref:year-quarter-province-product-drug)"
)
```
